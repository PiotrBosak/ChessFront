var n,e,t,r={};t={fromString:function(n){return n.fromString},IsString:function(n){this.fromString=n}};var u,i;i={otherwise:!0};var a,o,c;o=function(n){return function(e){return function(t){return(0|t)===t?n(t):e}}},c=function(n){return n};var f;var l,v,s,d,p=function(n){return function(e){return function(t){return function(r){return function(u){return r<u?n:r===u?e:t}}}}};v=p,s=p,d=p;var m,w,h,b,y=function(n){return function(e){return n===e}};w=y,h=y,b=y;var g=function(n){this.eq=n},E=new g(y),A=new g(b),S=new g(h),M=new g(w),k=function(n){return n.eq};m={Eq:g,eq:k,notEq:function(n){return function(e){return function(t){return k(M)(k(n)(e)(t))(!1)}}},eqBoolean:M,eqInt:S,eqNumber:A,eqString:E};var T,F=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),C=new m.Eq((function(n){return function(e){return n instanceof F&&e instanceof F||(n instanceof I&&e instanceof I||n instanceof P&&e instanceof P)}})),N=function(n,e){this.Eq0=n,this.compare=e},L=new N((function(n){return m.eqString}),d((T={LT:F,GT:I,EQ:P,eqOrdering:C}).LT.value)(T.EQ.value)(T.GT.value)),q=new N((function(n){return m.eqNumber}),s(T.LT.value)(T.EQ.value)(T.GT.value)),R=new N((function(n){return m.eqInt}),v(T.LT.value)(T.EQ.value)(T.GT.value)),B=function(n){return n.compare},_=function(n){return function(e){return function(t){var r=B(n)(e)(t);if(r instanceof T.LT)return t;if(r instanceof T.EQ)return e;if(r instanceof T.GT)return e;throw new Error("Failed pattern match at Data.Ord (line 176, column 3 - line 179, column 12): "+[r.constructor.name])}}},J=function(n){return function(e){return function(t){var r=B(n)(e)(t);if(r instanceof T.LT)return e;if(r instanceof T.EQ)return e;if(r instanceof T.GT)return t;throw new Error("Failed pattern match at Data.Ord (line 167, column 3 - line 170, column 12): "+[r.constructor.name])}}};l={Ord:N,compare:B,lessThanOrEq:function(n){return function(e){return function(t){return!(B(n)(e)(t)instanceof T.GT)}}},greaterThanOrEq:function(n){return function(e){return function(t){return!(B(n)(e)(t)instanceof T.LT)}}},min:J,max:_,clamp:function(n){return function(e){return function(t){return function(r){return J(n)(t)(_(n)(e)(r))}}}},ordInt:R,ordNumber:q,ordString:L};var D=function(n,e,t){this.Ord0=n,this.bottom=e,this.top=t},O=new D((function(n){return l.ordInt}),-2147483648,2147483647);f={Bounded:D,bottom:function(n){return n.bottom},top:function(n){return n.top},boundedInt:O};var U,x,H,Q={};H={flip:function(n){return function(e){return function(t){return n(t)(e)}}},const:function(n){return function(e){return n}},apply:function(n){return function(e){return n(e)}},applyFlipped:function(n){return function(e){return e(n)}}};var W;W={unit:{}};var G=function(n){this.map=n},z=function(n){return n.map},K=new G((function(n){return function(e){for(var t=e.length,r=new Array(t),u=0;u<t;u++)r[u]=n(e[u]);return r}}));x={Functor:G,map:z,void:function(n){return z(n)(H.const(W.unit))},voidLeft:function(n){return function(e){return function(t){return z(n)(H.const(t))(e)}}},functorArray:K};var V,j;j=function(n){return function(e){return 0===n.length?e:0===e.length?n:n.concat(e)}};var X=function(n){this.append=n},Y=new X((function(n){return function(e){return n+e}})),Z=new X(j),$=function(n,e){this.Functor0=n,this.alt=e},nn=new $((function(n){return x.functorArray}),(V={Semigroup:X,append:function(n){return n.append},semigroupString:Y,semigroupArray:Z}).append(V.semigroupArray));U={Alt:$,altArray:nn};var en,tn,rn,un;un=function(n){return function(e){for(var t=n.length,r=e.length,u=new Array(t*r),i=0,a=0;a<t;a++)for(var o=n[a],c=0;c<r;c++)u[i++]=o(e[c]);return u}};var an,on,cn=function(n){this.compose=n},fn=new cn((function(n){return function(e){return function(t){return n(e(t))}}})),ln=function(n){return n.compose};on={compose:ln,Semigroupoid:cn,composeFlipped:function(n){return function(e){return function(t){return ln(n)(t)(e)}}},semigroupoidFn:fn};var vn=function(n,e){this.Semigroupoid0=n,this.identity=e},sn=new vn((function(n){return on.semigroupoidFn}),(function(n){return n}));an={Category:vn,identity:function(n){return n.identity},categoryFn:sn};var dn=function(n,e){this.Functor0=n,this.apply=e},pn=new dn((function(n){return x.functorArray}),un),mn=function(n){return n.apply};rn={Apply:dn,apply:mn,applySecond:function(n){return function(e){return function(t){return mn(n)(x.map(n.Functor0())(H.const(an.identity(an.categoryFn)))(e))(t)}}},applyArray:pn};var wn=function(n,e){this.Apply0=n,this.pure=e},hn=function(n){return n.pure},bn=new wn((function(n){return rn.applyArray}),(function(n){return[n]}));tn={Applicative:wn,pure:hn,liftA1:function(n){return function(e){return function(t){return rn.apply(n.Apply0())(hn(n)(e))(t)}}},unless:function(n){return function(e){return function(t){if(!e)return t;if(e)return hn(n)(W.unit);throw new Error("Failed pattern match at Control.Applicative (line 66, column 1 - line 66, column 65): "+[e.constructor.name,t.constructor.name])}}},when:function(n){return function(e){return function(t){if(e)return t;if(!e)return hn(n)(W.unit);throw new Error("Failed pattern match at Control.Applicative (line 61, column 1 - line 61, column 63): "+[e.constructor.name,t.constructor.name])}}},applicativeArray:bn};var yn,gn=function(n,e){this.Alt0=n,this.empty=e},En=new gn((function(n){return U.altArray}),[]);yn={Plus:gn,empty:function(n){return n.empty},plusArray:En};var An=function(n,e){this.Applicative0=n,this.Plus1=e},Sn=new An((function(n){return tn.applicativeArray}),(function(n){return yn.plusArray}));en={Alternative:An,guard:function(n){return function(e){if(e)return tn.pure(n.Applicative0())(W.unit);if(!e)return yn.empty(n.Plus1());throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},alternativeArray:Sn};var Mn,kn=function(n,e){this.Apply0=n,this.bind=e},Tn=function(n){this.discard=n},Fn=new kn((function(n){return rn.applyArray}),(function(n){return function(e){for(var t=[],r=0,u=n.length;r<u;r++)Array.prototype.push.apply(t,e(n[r]));return t}})),In=function(n){return n.bind},Pn=function(n){return H.flip(In(n))},Cn=new Tn((function(n){return In(n)}));Mn={Bind:kn,bind:In,bindFlipped:Pn,Discard:Tn,discard:function(n){return n.discard},composeKleisliFlipped:function(n){return function(e){return function(t){return function(r){return Pn(n)(e)(t(r))}}}},bindArray:Fn,discardUnit:Cn};var Nn,Ln;Ln=function(n){return function(e){for(var t=[],r=0,u=e.length;r<u;r++)t[r]=n(e[r]);return"["+t.join(",")+"]"}};var qn=function(n){this.show=n},Rn=new qn((function(n){var e=n.toString();return isNaN(e+".0")?e:e+".0"})),Bn=function(n){return n.show};Nn={Show:qn,show:Bn,showNumber:Rn,showArray:function(n){return new qn(Ln(Bn(n)))}};var _n=function(){function n(){}return n.value=new n,n}(),Jn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Dn=function(n){return function(e){return function(t){if(t instanceof _n)return n;if(t instanceof Jn)return e(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 230, column 1 - line 230, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},On=Dn(!0)(H.const(!1)),Un=Dn(!1)(H.const(!0)),xn=new x.Functor((function(n){return function(e){return e instanceof Jn?new Jn(n(e.value0)):_n.value}})),Hn=new rn.Apply((function(n){return xn}),(function(n){return function(e){if(n instanceof Jn)return x.map(xn)(n.value0)(e);if(n instanceof _n)return _n.value;throw new Error("Failed pattern match at Data.Maybe (line 68, column 1 - line 70, column 30): "+[n.constructor.name,e.constructor.name])}})),Qn=new Mn.Bind((function(n){return Hn}),(function(n){return function(e){if(n instanceof Jn)return e(n.value0);if(n instanceof _n)return _n.value;throw new Error("Failed pattern match at Data.Maybe (line 126, column 1 - line 128, column 28): "+[n.constructor.name,e.constructor.name])}})),Wn=new tn.Applicative((function(n){return Hn}),Jn.create),Gn=new U.Alt((function(n){return xn}),(function(n){return function(e){return n instanceof _n?e:n}})),zn=new yn.Plus((function(n){return Gn}),_n.value),Kn=new en.Alternative((function(n){return Wn}),(function(n){return zn}));Q={Nothing:_n,Just:Jn,maybe:Dn,fromMaybe:function(n){return Dn(n)(an.identity(an.categoryFn))},isJust:Un,isNothing:On,fromJust:function(n){return function(n){if(n instanceof Jn)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 281, column 1 - line 281, column 46): "+[n.constructor.name])}},functorMaybe:xn,applyMaybe:Hn,applicativeMaybe:Wn,altMaybe:Gn,plusMaybe:zn,alternativeMaybe:Kn,bindMaybe:Qn,eqMaybe:function(n){return new m.Eq((function(e){return function(t){return e instanceof _n&&t instanceof _n||e instanceof Jn&&t instanceof Jn&&m.eq(n)(e.value0)(t.value0)}}))},showMaybe:function(n){return new Nn.Show((function(e){if(e instanceof Jn)return"(Just "+Nn.show(n)(e.value0)+")";if(e instanceof _n)return"Nothing";throw new Error("Failed pattern match at Data.Maybe (line 216, column 1 - line 218, column 28): "+[e.constructor.name])}))}};var Vn,jn={};Vn=isFinite,jn={isFinite:Vn};var Xn,Yn,Zn,$n={};Xn=Math.abs,Yn=function(n){return function(e){return n%e}},Zn=Math.round,$n={abs:Xn,round:Zn,remainder:Yn};var ne=o(Q.Just.create)(Q.Nothing.value);a={fromNumber:ne,round:function(n){return function(n){if(!jn.isFinite(n))return 0;if(n>=f.top(f.boundedInt))return f.top(f.boundedInt);if(n<=f.bottom(f.boundedInt))return f.bottom(f.boundedInt);if(i.otherwise)return Q.fromMaybe(0)(ne(n));throw new Error("Failed pattern match at Data.Int (line 66, column 1 - line 66, column 29): "+[n.constructor.name])}($n.round(n))},toNumber:c};var ee=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),te=function(n){return function(e){return function(t){return function(r){var u=l.clamp(l.ordInt)(0)(255)(n),o=a.toNumber(u)/255,c=l.clamp(l.ordInt)(0)(255)(e),f=a.toNumber(c)/255,v=l.clamp(l.ordInt)(0)(255)(t),s=l.max(l.ordInt)(l.max(l.ordInt)(u)(c))(v),d=l.min(l.ordInt)(l.min(l.ordInt)(u)(c))(v),p=s-d|0,m=a.toNumber(p)/255,w=a.toNumber(s+d|0)/510,h=function(){if(0===p)return 0;if(i.otherwise)return m/(1-$n.abs(2*w-1));throw new Error("Failed pattern match at Color (line 157, column 5 - line 158, column 75): ")}(),b=a.toNumber(v)/255,y=60*function(n){if(0===n)return 0;if(s===u)return(e=(f-b)/m,function(n){return $n.remainder($n.remainder(e)(n)+n)(n)})(6);var e;if(s===c)return(b-o)/m+2;if(i.otherwise)return(o-f)/m+4;throw new Error("Failed pattern match at Color (line 148, column 5 - line 148, column 17): "+[n.constructor.name])}(p);return new ee(y,h,w,r)}}}};u={rgba:te,rgb:function(n){return function(e){return function(t){return te(n)(e)(t)(1)}}},cssStringHSLA:function(n){var e=function(n){return Nn.show(Nn.showNumber)(a.toNumber(a.round(100*n))/100)},t=e(100*n.value1)+"%",r=e(100*n.value2)+"%",u=e(n.value0),i=Nn.show(Nn.showNumber)(n.value3);return 1===n.value3?"hsl("+u+", "+t+", "+r+")":"hsla("+u+", "+t+", "+r+", "+i+")"}};var re,ue,ie=function(n){this.dimap=n},ae=new ie((function(n){return function(e){return function(t){return function(r){return e(t(n(r)))}}}}));ue={Profunctor:ie,profunctorFn:ae};var oe={},ce=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),fe=new x.Functor((function(n){return function(e){return new ce(e.value0,n(e.value1))}})),le=function(n,e,t){this.Profunctor0=n,this.first=e,this.second=t},ve=new le((function(n){return ue.profunctorFn}),(function(n){return function(e){return new oe.Tuple(n(e.value0),e.value1)}}),x.map((oe={Tuple:ce,fst:function(n){return n.value0},snd:function(n){return n.value1},functorTuple:fe}).functorTuple));re={second:function(n){return n.second},Strong:le,strongFn:ve};var se,de,pe,me,we,he=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),be=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ye=function(n){return n},ge=function(n){this.value=n},Ee=function(n){return n},Ae=new V.Semigroup((function(n){return function(e){if(n instanceof be&&e instanceof be)return be.create(n.value0+e.value0);if(n instanceof be&&e instanceof he)return he.create(x.map(x.functorArray)(re.second(re.strongFn)((function(e){return n.value0+e})))(e.value0));if(n instanceof he&&e instanceof be)return he.create(x.map(x.functorArray)(re.second(re.strongFn)((function(n){return e.value0+n})))(n.value0));if(n instanceof he&&e instanceof he)return he.create(V.append(V.semigroupArray)(n.value0)(e.value0));throw new Error("Failed pattern match at CSS.Property (line 23, column 1 - line 27, column 59): "+[n.constructor.name,e.constructor.name])}})),Se=new V.Semigroup((function(n){return function(e){return V.append(Ae)(n)(e)}})),Me=new t.IsString(be.create),ke=new t.IsString((se=t.fromString(Me),function(n){return se(n)})),Te=new ge((de=t.fromString(ke),function(n){return de(u.cssStringHSLA(n))})),Fe=new ge((pe=t.fromString(ke),me=Nn.show(Nn.showNumber),function(n){return pe(me(n))})),Ie=new t.IsString((we=t.fromString(Me),function(n){return we(n)}));e={value:function(n){return n.value},Prefixed:he,Plain:be,Key:Ee,cast:function(n){return n},Value:ye,Val:ge,isStringPrefixed:Me,semigroupPrefixed:Ae,isStringKey:Ie,isStringValue:ke,semigroupValue:Se,valNumber:Fe,valColor:Te};var Pe,Ce,Ne,Le;Le={Monad:function(n,e){this.Applicative0=n,this.Bind1=e},unlessM:function(n){return function(e){return function(t){return Mn.bind(n.Bind1())(e)((function(e){return tn.unless(n.Applicative0())(e)(t)}))}}},ap:function(n){return function(e){return function(t){return Mn.bind(n.Bind1())(e)((function(e){return Mn.bind(n.Bind1())(t)((function(t){return tn.pure(n.Applicative0())(e(t))}))}))}}}};var qe;qe={tell:function(n){return n.tell},MonadTell:function(n,e,t){this.Monad1=n,this.Semigroup0=e,this.tell=t}};var Re,Be=function(n,e){this.Semigroup0=n,this.mempty=e},_e=new Be((function(n){return V.semigroupArray}),[]);Re={Monoid:Be,mempty:function(n){return n.mempty},monoidArray:_e};var Je=function(n){return n},De=function(n){return function(e){return n(e)}},Oe=function(n){return new x.Functor((function(e){return De(x.map(n)((function(n){return new oe.Tuple(e(n.value0),n.value1)})))}))},Ue=function(n){return function(e){return new rn.Apply((function(n){return Oe(e.Functor0())}),(function(t){return function(r){return rn.apply(e)(x.map(e.Functor0())((function(e){return function(t){return new oe.Tuple(e.value0(t.value0),V.append(n)(e.value1)(t.value1))}}))(t))(r)}}))}},xe=function(n){return function(e){return new Mn.Bind((function(t){return Ue(n)(e.Apply0())}),(function(t){return function(r){return Mn.bind(e)(t)((function(t){var u=r(t.value0);return x.map(e.Apply0().Functor0())((function(e){return new oe.Tuple(e.value0,V.append(n)(t.value1)(e.value1))}))(u)}))}}))}},He=function(n){return function(e){return new tn.Applicative((function(t){return Ue(n.Semigroup0())(e.Apply0())}),(function(t){return tn.pure(e)(new oe.Tuple(t,Re.mempty(n)))}))}},Qe=function(n){return function(e){return new Le.Monad((function(t){return He(n)(e.Applicative0())}),(function(t){return xe(n.Semigroup0())(e.Bind1())}))}};Ne={WriterT:Je,runWriterT:function(n){return n},mapWriterT:De,functorWriterT:Oe,applyWriterT:Ue,applicativeWriterT:He,bindWriterT:xe,monadWriterT:Qe,monadTellWriterT:function(n){return function(e){return new qe.MonadTell((function(t){return Qe(n)(e)}),(function(e){return n.Semigroup0()}),(t=tn.pure(e.Applicative0()),r=oe.Tuple.create(W.unit),function(n){return t(r(n))}));var t,r}}};var We,Ge,ze;ze={unsafeCoerce:function(n){return n}};Ge={coerce:function(n){return ze.unsafeCoerce}};var Ke,Ve=(Ke=(We={wrap:function(n){return Ge.coerce()},unwrap:function(n){return Ge.coerce()}}).unwrap(),function(n){return Ke(Ne.runWriterT(n))});Ce={runWriter:Ve,execWriter:function(n){return oe.snd(Ve(n))}};var je,Xe,Ye,Ze,$e,nt,et,tt,rt,ut,it={};je=function(){function n(n,e){this.head=n,this.tail=e}var e={};function t(e){return function(t){return new n(e,t)}}return function(n){return function(r){return function(n){for(var t=[],r=0,u=n;u!==e;)t[r++]=u.head,u=u.tail;return t}(n(t)(e)(r))}}}(),Xe=function(n){return n.length},Ye=function(n){return function(e){return function(t){return function(r){return r<0||r>=t.length?e:n(t[r])}}}},Ze=function(n){return function(e){return function(t){return function(r){for(var u=0,i=r.length;u<i;u++)if(t(r[u]))return n(u);return e}}}},$e=function(n){return function(e){return function(t){return function(r){if(t<0||t>=r.length)return e;var u=r.slice();return u.splice(t,1),n(u)}}}},nt=function(n){return function(e){return e.filter(n)}},et=function(){function n(e,t,r,u,i,a){var o,c,f,l,v,s;for((o=i+(a-i>>1))-i>1&&n(e,t,u,r,i,o),a-o>1&&n(e,t,u,r,o,a),c=i,f=o,l=i;c<o&&f<a;)v=u[c],s=u[f],t(e(v)(s))>0?(r[l++]=s,++f):(r[l++]=v,++c);for(;c<o;)r[l++]=u[c++];for(;f<a;)r[l++]=u[f++]}return function(e){return function(t){return function(r){var u;return r.length<2?r:(u=r.slice(0),n(e,t,u,r.slice(0),0,r.length),u)}}}}(),tt=function(n){return function(e){return function(t){for(var r=e.length<t.length?e.length:t.length,u=new Array(r),i=0;i<r;i++)u[i]=n(e[i])(t[i]);return u}}},rt=function(n){return function(e){for(var t=e.length,r=0;r<t;r++)if(!n(e[r]))return!1;return!0}},ut=function(n){return function(e){return n[e]}};var at,ot,ct;ot=function(n){return function(e){return function(t){for(var r=e,u=t.length-1;u>=0;u--)r=n(t[u])(r);return r}}},ct=function(n){return function(e){return function(t){for(var r=e,u=t.length,i=0;i<u;i++)r=n(r)(t[i]);return r}}};var ft={},lt=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),vt=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}();ft={Left:lt,Right:vt,either:function(n){return function(e){return function(t){if(t instanceof lt)return n(t.value0);if(t instanceof vt)return e(t.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}};var st,dt=new V.Semigroup((function(n){return function(e){return n instanceof Q.Just?n:e}})),pt=new Re.Monoid((function(n){return dt}),Q.Nothing.value);st={First:function(n){return n},semigroupFirst:dt,monoidFirst:pt};var mt=function(n,e,t){this.foldMap=n,this.foldl=e,this.foldr=t},wt=function(n){return n.foldr},ht=function(n){return function(e){return function(t){return wt(e)((r=rn.applySecond(n.Apply0()),function(n){return r(t(n))}))(tn.pure(n)(W.unit));var r}}},bt=new mt((function(n){return function(e){return function(t){if(t instanceof Q.Nothing)return Re.mempty(n);if(t instanceof Q.Just)return e(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name])}}}),(function(n){return function(e){return function(t){if(t instanceof Q.Nothing)return e;if(t instanceof Q.Just)return n(e)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}),(function(n){return function(e){return function(t){if(t instanceof Q.Nothing)return e;if(t instanceof Q.Just)return n(t.value0)(e);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}})),yt=new mt((function(n){return function(e){return function(t){if(t instanceof ft.Left)return Re.mempty(n);if(t instanceof ft.Right)return e(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): "+[e.constructor.name,t.constructor.name])}}}),(function(n){return function(e){return function(t){if(t instanceof ft.Left)return e;if(t instanceof ft.Right)return n(e)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}),(function(n){return function(e){return function(t){if(t instanceof ft.Left)return e;if(t instanceof ft.Right)return n(t.value0)(e);throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}})),gt=function(n){return function(e){return function(t){return wt(n)((function(n){return function(r){return V.append(e.Semigroup0())(t(n))(r)}}))(Re.mempty(e))}}},Et=new mt((function(n){return gt(Et)(n)}),ct,ot),At=function(n){return n.foldMap};at={Foldable:mt,foldr:wt,foldl:function(n){return n.foldl},foldMap:At,foldMapDefaultR:gt,traverse_:ht,for_:function(n){return function(e){return H.flip(ht(n)(e))}},lookup:function(n){return function(e){return function(t){var r=We.unwrap(),u=At(n)(st.monoidFirst)((function(n){return m.eq(e)(t)(n.value0)?new Q.Just(n.value1):Q.Nothing.value}));return function(n){return r(u(n))}}}},foldableArray:Et,foldableMaybe:bt,foldableEither:yt};var St=tt(oe.Tuple.create),Mt=function(n){return ut},kt=function(n){return et(n)((function(n){if(n instanceof T.GT)return 1;if(n instanceof T.EQ)return 0;if(n instanceof T.LT)return-1;throw new Error("Failed pattern match at Data.Array (line 831, column 31 - line 834, column 11): "+[n.constructor.name])}))},Tt=function(n){return[n]},Ft=Ye(Q.Just.create)(Q.Nothing.value),It=at.foldl(at.foldableArray),Pt=Ze(Q.Just.create)(Q.Nothing.value),Ct=function(n){return function(e){return Pt((function(t){return m.eq(n)(t)(e)}))}},Nt=$e(Q.Just.create)(Q.Nothing.value),Lt=H.flip(Mn.bind(Mn.bindArray));it={fromFoldable:function(n){return je(at.foldr(n))},singleton:Tt,cons:function(n){return function(e){return V.append(V.semigroupArray)([n])(e)}},head:function(n){return Ft(n)(0)},index:Ft,elem:function(n){return function(e){return function(t){return Q.isJust(Ct(n)(e)(t))}}},elemIndex:Ct,find:function(n){return function(e){return x.map(Q.functorMaybe)(Mt()(e))(Pt(n)(e))}},findIndex:Pt,deleteAt:Nt,concatMap:Lt,mapMaybe:function(n){return Lt((e=Q.maybe([])(Tt),function(t){return e(n(t))}));var e},foldl:It,sort:function(n){return function(e){return kt(l.compare(n))(e)}},sortBy:kt,deleteBy:function(n){return function(e){return function(t){return 0===t.length?[]:Q.maybe(t)((function(n){return Q.fromJust()(Nt(n)(t))}))(Pt(n(e))(t))}}},zip:St,unsafeIndex:Mt,length:Xe,filter:nt,zipWith:tt,all:rt};var qt,Rt=function(n){return n},Bt=new x.Functor((function(n){return function(e){return n(e)}})),_t=new rn.Apply((function(n){return Bt}),(function(n){return function(e){return n(e)}})),Jt=new Mn.Bind((function(n){return _t}),(function(n){return function(e){return e(n)}})),Dt=new tn.Applicative((function(n){return _t}),Rt),Ot=new Le.Monad((function(n){return Dt}),(function(n){return Jt}));qt={Identity:Rt,functorIdentity:Bt,applyIdentity:_t,applicativeIdentity:Dt,bindIdentity:Jt,monadIdentity:Ot};var Ut,xt=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Ht=function(n){return n},Qt=(Ut=qe.tell(Ne.monadTellWriterT(Re.monoidArray)(qt.monadIdentity)),function(n){return Ut(it.singleton(n))}),Wt=new x.Functor((function(n){return function(e){return x.map(Ne.functorWriterT(qt.functorIdentity))(n)(e)}})),Gt=new rn.Apply((function(n){return Wt}),(function(n){return function(e){return rn.apply(Ne.applyWriterT(V.semigroupArray)(qt.applyIdentity))(n)(e)}})),zt=(Pe={Property:xt,S:Ht,runS:function(n){return Ce.execWriter(n)},rule:Qt,key:function(n){return function(t){return function(r){return Qt(new xt(e.cast(t),e.value(n)(r)))}}},functorStyleM:Wt,applyStyleM:Gt}).key(e.valColor)(t.fromString(e.isStringKey)("background-color"));r={backgroundColor:zt};var Kt,Vt,jt={};Vt={auto:function(n){return n.auto},Auto:function(n){this.auto=n}};var Xt,Yt=function(n){return n},Zt=new e.Val((function(n){return n})),$t=t.fromString(e.isStringValue)("0"),nr=new t.IsString((Xt=t.fromString(e.isStringValue),function(n){return Xt(n)})),er=new Vt.Auto(t.fromString(nr)("auto")),tr=Pe.key((Kt={Size:Yt,nil:$t,px:function(n){return V.append(e.semigroupValue)(e.value(e.valNumber)(n))(t.fromString(e.isStringValue)("px"))},pct:function(n){return V.append(e.semigroupValue)(e.value(e.valNumber)(n))(t.fromString(e.isStringValue)("%"))},isStringSize:nr,valSize:Zt,autoSize:er}).valSize)(t.fromString(e.isStringKey)("border-spacing"));jt={borderSpacing:tr};var rr={},ur=function(n){return n},ir=new e.Val((function(n){return n})),ar=t.fromString(e.isStringValue)("inline-block"),or=Pe.key(ir)(t.fromString(e.isStringKey)("display")),cr=t.fromString(e.isStringValue)("block");rr={Display:ur,block:cr,inlineBlock:ar,display:or,valDisplay:ir};var fr={},lr=Pe.key(Kt.valSize)(t.fromString(e.isStringKey)("width")),vr=Pe.key(Kt.valSize)(t.fromString(e.isStringKey)("margin-right")),sr=Pe.key(Kt.valSize)(t.fromString(e.isStringKey)("margin-left")),dr=Pe.key(Kt.valSize)(t.fromString(e.isStringKey)("height"));fr={width:lr,height:dr,marginLeft:sr,marginRight:vr};var pr,mr=function(n){return n.state};pr={state:mr,MonadState:function(n,e){this.Monad0=n,this.state=e},get:function(n){return mr(n)((function(n){return new oe.Tuple(n,n)}))},put:function(n){return function(e){return mr(n)((function(n){return new oe.Tuple(W.unit,e)}))}},modify_:function(n){return function(e){return mr(n)((function(n){return new oe.Tuple(W.unit,e(n))}))}}};var wr,hr={},br={};wr={Unfoldable:function(n,e){this.Unfoldable10=n,this.unfoldr=e},unfoldr:function(n){return n.unfoldr}};var yr;yr={Unfoldable1:function(n){this.unfoldr1=n}};var gr,Er=function(){function n(){}return n.value=new n,n}(),Ar=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Sr=new x.Functor((function(n){var e;return e=Er.value,function(t){var r,u=e,i=!1;function a(e,r){return r instanceof Ar&&r.value1 instanceof Ar&&r.value1.value1 instanceof Ar?(u=new Ar(r,e),void(t=r.value1.value1.value1)):(i=!0,(o=e,function(e){for(var t,r,u,i=o,a=!1;!a;)u=e,t=(r=i)instanceof Ar&&r.value0 instanceof Ar&&r.value0.value1 instanceof Ar&&r.value0.value1.value1 instanceof Ar?(i=r.value1,void(e=new Ar(n(r.value0.value0),new Ar(n(r.value0.value1.value0),new Ar(n(r.value0.value1.value1.value0),u))))):(a=!0,u);return t})((a=r)instanceof Ar&&a.value1 instanceof Ar&&a.value1.value1 instanceof Er?new Ar(n(a.value0),new Ar(n(a.value1.value0),Er.value)):a instanceof Ar&&a.value1 instanceof Er?new Ar(n(a.value0),Er.value):Er.value));var a,o}for(;!i;)r=a(u,t);return r}})),Mr=new at.Foldable((function(n){return function(e){return at.foldl(Mr)((function(t){var r=V.append(n.Semigroup0())(t);return function(n){return r(e(n))}}))(Re.mempty(n))}}),(function(n){return function(e){return function(t){var r,u=e,i=!1;function a(e,r){if(r instanceof Er)return i=!0,e;if(r instanceof Ar)return u=n(e)(r.value0),void(t=r.value1);throw new Error("Failed pattern match at Data.List.Types (line 112, column 12 - line 114, column 30): "+[r.constructor.name])}for(;!i;)r=a(u,t);return r}}}),(function(n){return function(e){var t,r=(t=Er.value,function(n){var e,r=t,u=!1;function i(e,t){if(t instanceof Er)return u=!0,e;if(t instanceof Ar)return r=new Ar(t.value0,e),void(n=t.value1);throw new Error("Failed pattern match at Data.List.Types (line 108, column 7 - line 108, column 23): "+[e.constructor.name,t.constructor.name])}for(;!u;)e=i(r,n);return e}),u=at.foldl(Mr)(H.flip(n))(e);return function(n){return u(r(n))}}})),kr=new V.Semigroup((function(n){return function(e){return at.foldr(Mr)(Ar.create)(e)(n)}})),Tr=new yr.Unfoldable1((function(n){return function(e){var t;return(t=e,function(e){var r,u=t,i=!1;function a(t,r){var a=n(t);if(a.value1 instanceof Q.Just)return u=a.value1.value0,void(e=new Ar(a.value0,r));if(a.value1 instanceof Q.Nothing)return i=!0,at.foldl(Mr)(H.flip(Ar.create))(Er.value)(new Ar(a.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 136, column 22 - line 138, column 61): "+[a.constructor.name])}for(;!i;)r=a(u,e);return r})(Er.value)}})),Fr=new wr.Unfoldable((function(n){return Tr}),(function(n){return function(e){var t;return(t=e,function(e){var r,u=t,i=!1;function a(t,r){var a=n(t);if(a instanceof Q.Nothing)return i=!0,at.foldl(Mr)(H.flip(Ar.create))(Er.value)(r);if(a instanceof Q.Just)return u=a.value0.value1,void(e=new Ar(a.value0.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 143, column 22 - line 145, column 52): "+[a.constructor.name])}for(;!i;)r=a(u,e);return r})(Er.value)}})),Ir=new rn.Apply((function(n){return Sr}),(function(n){return function(e){if(n instanceof Er)return Er.value;if(n instanceof Ar)return V.append(kr)(x.map(Sr)(n.value0)(e))(rn.apply(Ir)(n.value1)(e));throw new Error("Failed pattern match at Data.List.Types (line 158, column 1 - line 160, column 48): "+[n.constructor.name,e.constructor.name])}})),Pr=new tn.Applicative((function(n){return Ir}),(function(n){return new Ar(n,Er.value)})),Cr=new U.Alt((function(n){return Sr}),V.append(kr)),Nr=new yn.Plus((function(n){return Cr}),Er.value),Lr=function(n){return new br.Cons(n,br.Nil.value)},qr=function(n){var e=function(t){return function(r){if(t instanceof br.Cons&&r instanceof br.Cons){if(m.eq(T.eqOrdering)(n(t.value0)(r.value0))(T.GT.value))return new br.Cons(r.value0,e(t)(r.value1));if(i.otherwise)return new br.Cons(t.value0,e(t.value1)(r))}if(t instanceof br.Nil)return r;if(r instanceof br.Nil)return t;throw new Error("Failed pattern match at Data.List (line 477, column 3 - line 477, column 38): "+[t.constructor.name,r.constructor.name])}},t=function(n){return n instanceof br.Cons&&n.value1 instanceof br.Cons?new br.Cons(e(n.value0)(n.value1.value0),t(n.value1.value1)):n},r=function(e){if(e instanceof br.Cons&&e.value1 instanceof br.Cons){if(m.eq(T.eqOrdering)(n(e.value0)(e.value1.value0))(T.GT.value))return u(e.value1.value0)(Lr(e.value0))(e.value1.value1);if(i.otherwise)return a(e.value1.value0)((function(n){return new br.Cons(e.value0,n)}))(e.value1.value1)}return Lr(e)},u=function(e){return function(t){return function(u){var i,a,o,c,f=e,l=t,v=!1;for(;!v;)a=f,o=l,i=(c=u)instanceof br.Cons&&m.eq(T.eqOrdering)(n(a)(c.value0))(T.GT.value)?(f=c.value0,l=new br.Cons(a,o),void(u=c.value1)):(v=!0,new br.Cons(new br.Cons(a,o),r(c)));return i}}},a=function(e){return function(t){return function(u){var i,a=e,o=t,c=!1;function f(e,t,i){return i instanceof br.Cons&&m.notEq(T.eqOrdering)(n(e)(i.value0))(T.GT.value)?(a=i.value0,o=function(n){return t(new br.Cons(e,n))},void(u=i.value1)):(c=!0,new br.Cons(t(Lr(e)),r(i)))}for(;!c;)i=f(a,o,u);return i}}};return function(n){return function(n){var e,r=!1;function u(e){if(e instanceof br.Cons&&e.value1 instanceof br.Nil)return r=!0,e.value0;n=t(e)}for(;!r;)e=u(n);return e}(r(n))}},Rr=(gr=(br={Nil:Er,Cons:Ar,NonEmptyList:function(n){return n},semigroupList:kr,functorList:Sr,foldableList:Mr,unfoldable1List:Tr,unfoldableList:Fr,applyList:Ir,applicativeList:Pr,altList:Cr,plusList:Nr}).Nil.value,function(n){var e,t=gr,r=!1;function u(e,u){if(u instanceof br.Nil)return r=!0,e;if(u instanceof br.Cons)return t=new br.Cons(u.value0,e),void(n=u.value1);throw new Error("Failed pattern match at Data.List (line 372, column 3 - line 372, column 19): "+[e.constructor.name,u.constructor.name])}for(;!r;)e=u(t,n);return e});hr={singleton:Lr,null:function(n){return n instanceof br.Nil},reverse:Rr,sort:function(n){return function(e){return qr(l.compare(n))(e)}},sortBy:qr};var Br={},_r=function(){function n(){}return n.value=new n,n}(),Jr=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Dr=function(){function n(n,e,t,r,u,i,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=i,this.value6=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(i){return function(a){return function(o){return new n(e,t,r,u,i,a,o)}}}}}}},n}(),Or=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Ur=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),xr=function(){function n(n,e,t,r,u,i){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=i}return n.create=function(e){return function(t){return function(r){return function(u){return function(i){return function(a){return new n(e,t,r,u,i,a)}}}}}},n}(),Hr=function(){function n(n,e,t,r,u,i){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=i}return n.create=function(e){return function(t){return function(r){return function(u){return function(i){return function(a){return new n(e,t,r,u,i,a)}}}}}},n}(),Qr=function(){function n(n,e,t,r,u,i){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=i}return n.create=function(e){return function(t){return function(r){return function(u){return function(i){return function(a){return new n(e,t,r,u,i,a)}}}}}},n}(),Wr=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Gr=function(n){if(n instanceof _r)return br.Nil.value;if(n instanceof Jr)return V.append(br.semigroupList)(Gr(n.value0))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value2))(Gr(n.value3)));if(n instanceof Dr)return V.append(br.semigroupList)(Gr(n.value0))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value2))(V.append(br.semigroupList)(Gr(n.value3))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value5))(Gr(n.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 626, column 1 - line 626, column 40): "+[n.constructor.name])},zr=function(n){return function(e){return new Jr(_r.value,n,e,_r.value)}},Kr=function(n){return function(e){return wr.unfoldr(n)((function(n){var e,t=!1;function r(e){if(e instanceof br.Nil)return t=!0,Q.Nothing.value;if(e instanceof br.Cons){if(e.value0 instanceof _r)return void(n=e.value1);if(e.value0 instanceof Jr&&e.value0.value0 instanceof _r&&e.value0.value3 instanceof _r)return t=!0,Q.Just.create(new oe.Tuple(new oe.Tuple(e.value0.value1,e.value0.value2),e.value1));if(e.value0 instanceof Jr&&e.value0.value0 instanceof _r)return t=!0,Q.Just.create(new oe.Tuple(new oe.Tuple(e.value0.value1,e.value0.value2),new br.Cons(e.value0.value3,e.value1)));if(e.value0 instanceof Jr)return void(n=new br.Cons(e.value0.value0,new br.Cons(zr(e.value0.value1)(e.value0.value2),new br.Cons(e.value0.value3,e.value1))));if(e.value0 instanceof Dr)return void(n=new br.Cons(e.value0.value0,new br.Cons(zr(e.value0.value1)(e.value0.value2),new br.Cons(e.value0.value3,new br.Cons(zr(e.value0.value4)(e.value0.value5),new br.Cons(e.value0.value6,e.value1))))));throw new Error("Failed pattern match at Data.Map.Internal (line 591, column 18 - line 600, column 71): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 590, column 3 - line 590, column 19): "+[e.constructor.name])}for(;!t;)e=r(n);return e}))(new br.Cons(e,br.Nil.value))}},Vr=function(n){return function(e){var t=l.compare(n);return function(n){var r,u=!1;function i(r){if(r instanceof _r)return u=!0,Q.Nothing.value;if(r instanceof Jr){var i=t(e)(r.value1);return i instanceof T.EQ?(u=!0,new Q.Just(r.value2)):i instanceof T.LT?void(n=r.value0):void(n=r.value3)}if(r instanceof Dr){var a=t(e)(r.value1);if(a instanceof T.EQ)return u=!0,new Q.Just(r.value2);var o=t(e)(r.value4);return o instanceof T.EQ?(u=!0,new Q.Just(r.value5)):a instanceof T.LT?void(n=r.value0):o instanceof T.GT?void(n=r.value6):void(n=r.value3)}throw new Error("Failed pattern match at Data.Map.Internal (line 211, column 5 - line 211, column 22): "+[r.constructor.name])}for(;!u;)r=i(n);return r}}},jr=function(n){if(n instanceof _r)return br.Nil.value;if(n instanceof Jr)return V.append(br.semigroupList)(jr(n.value0))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value1))(jr(n.value3)));if(n instanceof Dr)return V.append(br.semigroupList)(jr(n.value0))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value1))(V.append(br.semigroupList)(jr(n.value3))(V.append(br.semigroupList)(tn.pure(br.applicativeList)(n.value4))(jr(n.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 620, column 1 - line 620, column 38): "+[n.constructor.name])},Xr=function(n){return function(e){return function(t){var r,u=n,i=e,a=!1;function o(n,e,r){if(e instanceof br.Nil)return a=!0,r;if(e instanceof br.Cons){if(e.value0 instanceof Or)return u=n,i=e.value1,void(t=new Jr(r,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Ur)return u=n,i=e.value1,void(t=new Jr(e.value0.value0,e.value0.value1,e.value0.value2,r));if(e.value0 instanceof xr)return u=n,i=e.value1,void(t=new Dr(r,e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Hr)return u=n,i=e.value1,void(t=new Dr(e.value0.value0,e.value0.value1,e.value0.value2,r,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Qr)return u=n,i=e.value1,void(t=new Dr(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5,r));throw new Error("Failed pattern match at Data.Map.Internal (line 432, column 3 - line 437, column 88): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 429, column 1 - line 429, column 80): "+[e.constructor.name,r.constructor.name])}for(;!a;)r=o(u,i,t);return r}}},Yr=function(n){return function(e){return function(t){var r,u=l.compare(n);return r=br.Nil.value,function(i){var a,o=r,c=!1;function f(r,a){if(a instanceof _r)return c=!0,function(e){return function(t){var r,u=e,i=!1;function a(e,r){if(e instanceof br.Nil)return i=!0,new Jr(r.value0,r.value1,r.value2,r.value3);if(e instanceof br.Cons){if(e.value0 instanceof Or)return i=!0,Xr(n)(e.value1)(new Dr(r.value0,r.value1,r.value2,r.value3,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Ur)return i=!0,Xr(n)(e.value1)(new Dr(e.value0.value0,e.value0.value1,e.value0.value2,r.value0,r.value1,r.value2,r.value3));if(e.value0 instanceof xr)return u=e.value1,void(t=new Wr(new Jr(r.value0,r.value1,r.value2,r.value3),e.value0.value0,e.value0.value1,new Jr(e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof Hr)return u=e.value1,void(t=new Wr(new Jr(e.value0.value0,e.value0.value1,e.value0.value2,r.value0),r.value1,r.value2,new Jr(r.value3,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof Qr)return u=e.value1,void(t=new Wr(new Jr(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3),e.value0.value4,e.value0.value5,new Jr(r.value0,r.value1,r.value2,r.value3)));throw new Error("Failed pattern match at Data.Map.Internal (line 468, column 5 - line 473, column 108): "+[e.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 465, column 3 - line 465, column 56): "+[e.constructor.name,r.constructor.name])}for(;!i;)r=a(u,t);return r}}(r)(new Wr(_r.value,e,t,_r.value));if(a instanceof Jr){var f=u(e)(a.value1);return f instanceof T.EQ?(c=!0,Xr(n)(r)(new Jr(a.value0,e,t,a.value3))):f instanceof T.LT?(o=new br.Cons(new Or(a.value1,a.value2,a.value3),r),void(i=a.value0)):(o=new br.Cons(new Ur(a.value0,a.value1,a.value2),r),void(i=a.value3))}if(a instanceof Dr){var l=u(e)(a.value1);if(l instanceof T.EQ)return c=!0,Xr(n)(r)(new Dr(a.value0,e,t,a.value3,a.value4,a.value5,a.value6));var v=u(e)(a.value4);return v instanceof T.EQ?(c=!0,Xr(n)(r)(new Dr(a.value0,a.value1,a.value2,a.value3,e,t,a.value6))):l instanceof T.LT?(o=new br.Cons(new xr(a.value1,a.value2,a.value3,a.value4,a.value5,a.value6),r),void(i=a.value0)):l instanceof T.GT&&v instanceof T.LT?(o=new br.Cons(new Hr(a.value0,a.value1,a.value2,a.value4,a.value5,a.value6),r),void(i=a.value3)):(o=new br.Cons(new Qr(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),r),void(i=a.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 448, column 3 - line 448, column 55): "+[r.constructor.name,a.constructor.name])}for(;!c;)a=f(o,i);return a}}}},Zr=function(n){return function(e){var t,r=function(e){return function(t){var r,u=e,i=!1;function a(e,r){if(e instanceof br.Nil)return i=!0,r;if(e instanceof br.Cons){if(e.value0 instanceof Or&&e.value0.value2 instanceof _r&&r instanceof _r)return i=!0,Xr(n)(e.value1)(new Jr(_r.value,e.value0.value0,e.value0.value1,_r.value));if(e.value0 instanceof Ur&&e.value0.value0 instanceof _r&&r instanceof _r)return i=!0,Xr(n)(e.value1)(new Jr(_r.value,e.value0.value1,e.value0.value2,_r.value));if(e.value0 instanceof Or&&e.value0.value2 instanceof Jr)return u=e.value1,void(t=new Dr(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3));if(e.value0 instanceof Ur&&e.value0.value0 instanceof Jr)return u=e.value1,void(t=new Dr(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r));if(e.value0 instanceof Or&&e.value0.value2 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Jr(new Jr(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Jr(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6)));if(e.value0 instanceof Ur&&e.value0.value0 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Jr(new Jr(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Jr(e.value0.value0.value6,e.value0.value1,e.value0.value2,r)));if(e.value0 instanceof xr&&e.value0.value2 instanceof _r&&e.value0.value5 instanceof _r&&r instanceof _r)return i=!0,Xr(n)(e.value1)(new Dr(_r.value,e.value0.value0,e.value0.value1,_r.value,e.value0.value3,e.value0.value4,_r.value));if(e.value0 instanceof Hr&&e.value0.value0 instanceof _r&&e.value0.value5 instanceof _r&&r instanceof _r)return i=!0,Xr(n)(e.value1)(new Dr(_r.value,e.value0.value1,e.value0.value2,_r.value,e.value0.value3,e.value0.value4,_r.value));if(e.value0 instanceof Qr&&e.value0.value0 instanceof _r&&e.value0.value3 instanceof _r&&r instanceof _r)return i=!0,Xr(n)(e.value1)(new Dr(_r.value,e.value0.value1,e.value0.value2,_r.value,e.value0.value4,e.value0.value5,_r.value));if(e.value0 instanceof xr&&e.value0.value2 instanceof Jr)return i=!0,Xr(n)(e.value1)(new Jr(new Dr(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3),e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Hr&&e.value0.value0 instanceof Jr)return i=!0,Xr(n)(e.value1)(new Jr(new Dr(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Hr&&e.value0.value5 instanceof Jr)return i=!0,Xr(n)(e.value1)(new Jr(e.value0.value0,e.value0.value1,e.value0.value2,new Dr(r,e.value0.value3,e.value0.value4,e.value0.value5.value0,e.value0.value5.value1,e.value0.value5.value2,e.value0.value5.value3)));if(e.value0 instanceof Qr&&e.value0.value3 instanceof Jr)return i=!0,Xr(n)(e.value1)(new Jr(e.value0.value0,e.value0.value1,e.value0.value2,new Dr(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3,e.value0.value4,e.value0.value5,r)));if(e.value0 instanceof xr&&e.value0.value2 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Dr(new Jr(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Jr(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6),e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Hr&&e.value0.value0 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Dr(new Jr(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Jr(e.value0.value0.value6,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Hr&&e.value0.value5 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Dr(e.value0.value0,e.value0.value1,e.value0.value2,new Jr(r,e.value0.value3,e.value0.value4,e.value0.value5.value0),e.value0.value5.value1,e.value0.value5.value2,new Jr(e.value0.value5.value3,e.value0.value5.value4,e.value0.value5.value5,e.value0.value5.value6)));if(e.value0 instanceof Qr&&e.value0.value3 instanceof Dr)return i=!0,Xr(n)(e.value1)(new Dr(e.value0.value0,e.value0.value1,e.value0.value2,new Jr(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3),e.value0.value3.value4,e.value0.value3.value5,new Jr(e.value0.value3.value6,e.value0.value4,e.value0.value5,r)));throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 9 - line 542, column 136): "+[e.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 522, column 5 - line 542, column 136): "+[e.constructor.name])}for(;!i;)r=a(u,t);return r}},u=function(n){return function(e){var t,u=n,i=!1;function a(n,t){if(t instanceof Jr&&t.value0 instanceof _r&&t.value3 instanceof _r)return i=!0,r(n)(_r.value);if(t instanceof Jr)return u=new br.Cons(new Ur(t.value0,t.value1,t.value2),n),void(e=t.value3);if(t instanceof Dr&&t.value0 instanceof _r&&t.value3 instanceof _r&&t.value6 instanceof _r)return i=!0,r(new br.Cons(new Ur(_r.value,t.value1,t.value2),n))(_r.value);if(t instanceof Dr)return u=new br.Cons(new Qr(t.value0,t.value1,t.value2,t.value3,t.value4,t.value5),n),void(e=t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 554, column 5 - line 558, column 107): "+[t.constructor.name])}for(;!i;)t=a(u,e);return t}},i=function(n){var e,t=!1;function r(e){if(e instanceof Jr&&e.value3 instanceof _r)return t=!0,{key:e.value1,value:e.value2};if(e instanceof Jr)n=e.value3;else{if(e instanceof Dr&&e.value6 instanceof _r)return t=!0,{key:e.value4,value:e.value5};if(!(e instanceof Dr))throw new Error("Failed pattern match at Data.Map.Internal (line 545, column 33 - line 549, column 45): "+[e.constructor.name]);n=e.value6}}for(;!t;)e=r(n);return e},a=l.compare(n);return t=br.Nil.value,function(o){var c,f=t,l=!1;function v(t,c){if(c instanceof _r)return l=!0,Q.Nothing.value;if(c instanceof Jr){var v=a(e)(c.value1);if(c.value3 instanceof _r&&v instanceof T.EQ)return l=!0,new Q.Just(new oe.Tuple(c.value2,r(t)(_r.value)));if(v instanceof T.EQ){var s=i(c.value0);return l=!0,new Q.Just(new oe.Tuple(c.value2,u(new br.Cons(new Or(s.key,s.value,c.value3),t))(c.value0)))}return v instanceof T.LT?(f=new br.Cons(new Or(c.value1,c.value2,c.value3),t),void(o=c.value0)):(f=new br.Cons(new Ur(c.value0,c.value1,c.value2),t),void(o=c.value3))}if(c instanceof Dr){var d=c.value0 instanceof _r&&c.value3 instanceof _r&&c.value6 instanceof _r,p=(v=a(e)(c.value4),a(e)(c.value1));return d&&p instanceof T.EQ?(l=!0,new Q.Just(new oe.Tuple(c.value2,Xr(n)(t)(new Jr(_r.value,c.value4,c.value5,_r.value))))):d&&v instanceof T.EQ?(l=!0,new Q.Just(new oe.Tuple(c.value5,Xr(n)(t)(new Jr(_r.value,c.value1,c.value2,_r.value))))):p instanceof T.EQ?(s=i(c.value0),l=!0,new Q.Just(new oe.Tuple(c.value2,u(new br.Cons(new xr(s.key,s.value,c.value3,c.value4,c.value5,c.value6),t))(c.value0)))):v instanceof T.EQ?(s=i(c.value3),l=!0,new Q.Just(new oe.Tuple(c.value5,u(new br.Cons(new Hr(c.value0,c.value1,c.value2,s.key,s.value,c.value6),t))(c.value3)))):p instanceof T.LT?(f=new br.Cons(new xr(c.value1,c.value2,c.value3,c.value4,c.value5,c.value6),t),void(o=c.value0)):p instanceof T.GT&&v instanceof T.LT?(f=new br.Cons(new Hr(c.value0,c.value1,c.value2,c.value4,c.value5,c.value6),t),void(o=c.value3)):(f=new br.Cons(new Qr(c.value0,c.value1,c.value2,c.value3,c.value4,c.value5),t),void(o=c.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 34 - line 518, column 80): "+[c.constructor.name])}for(;!l;)c=v(f,o);return c}}},$r=new at.Foldable((function(n){return function(e){return function(t){return at.foldMap(br.foldableList)(n)(e)(Gr(t))}}}),(function(n){return function(e){return function(t){return at.foldl(br.foldableList)(n)(e)(Gr(t))}}}),(function(n){return function(e){return function(t){return at.foldr(br.foldableList)(n)(e)(Gr(t))}}})),nu=_r.value,eu=function(n){return function(e){return function(t){return Q.maybe(t)(oe.snd)(Zr(n)(e)(t))}}},tu=function(n){return function(e){return function(t){return function(r){var u=e(Vr(n)(t)(r));if(u instanceof Q.Nothing)return eu(n)(t)(r);if(u instanceof Q.Just)return Yr(n)(t)(u.value0)(r);throw new Error("Failed pattern match at Data.Map.Internal (line 563, column 15 - line 565, column 25): "+[u.constructor.name])}}}},ru=function(n){return function(e){return function(t){return function(r){return at.foldl(br.foldableList)((function(t){return function(r){return tu(n)((u=Q.maybe(r.value1)(e(r.value1)),function(n){return Q.Just.create(u(n))}))(r.value0)(t);var u}}))(r)(Kr(br.unfoldableList)(t))}}}},uu=function(n){return ru(n)(H.const)};Br={empty:nu,singleton:zr,insert:Yr,lookup:Vr,toUnfoldable:Kr,delete:eu,pop:Zr,alter:tu,keys:jr,values:Gr,union:uu,unionWith:ru,unions:function(n){return function(e){return at.foldl(e)(uu(n))(nu)}},foldableMap:$r};var iu,au,ou=module.require,cu=function(){try{return void 0===ou?void 0:ou("util")}catch(n){return}}();au=function(n,e){return void 0!==cu?console.log(cu.inspect(n,{depth:null,colors:!0})):console.log(n),e({})};iu={trace:function(n){return function(n){return function(e){return au(n,e)}}}};var fu,lu,vu,su,du,pu;vu=function(n){return Math.min(Math.abs(n),2147483647)},su=function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(n/-e)}},du=function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},pu=function(n){return function(e){return n/e}};var mu,wu,hu,bu;hu=function(n){return function(e){return n-e|0}},bu=function(n){return function(e){return n-e}};var yu,gu,Eu;gu=function(n){return function(e){return n+e|0}},Eu=function(n){return function(e){return n*e|0}};var Au=function(n,e,t,r){this.add=n,this.mul=e,this.one=t,this.zero=r},Su=new Au((function(n){return function(e){return n+e}}),(function(n){return function(e){return n*e}}),1,0),Mu=new Au(gu,Eu,1,0);yu={Semiring:Au,add:function(n){return n.add},zero:function(n){return n.zero},mul:function(n){return n.mul},semiringInt:Mu,semiringNumber:Su};var ku=function(n,e){this.Semiring0=n,this.sub=e},Tu=function(n){return n.sub},Fu=new ku((function(n){return yu.semiringNumber}),bu),Iu=new ku((function(n){return yu.semiringInt}),hu);wu={Ring:ku,sub:Tu,negate:function(n){return function(e){return Tu(n)(yu.zero(n.Semiring0()))(e)}},ringInt:Iu,ringNumber:Fu};var Pu=function(n){this.Ring0=n},Cu=new Pu((function(n){return wu.ringNumber})),Nu=new Pu((function(n){return wu.ringInt}));mu={CommutativeRing:Pu,commutativeRingInt:Nu,commutativeRingNumber:Cu};var Lu=function(n,e,t,r){this.CommutativeRing0=n,this.degree=e,this.div=t,this.mod=r},qu=new Lu((function(n){return mu.commutativeRingNumber}),(function(n){return 1}),pu,(function(n){return function(n){return 0}})),Ru=new Lu((function(n){return mu.commutativeRingInt}),vu,su,du);lu={EuclideanRing:Lu,div:function(n){return n.div},mod:function(n){return n.mod},euclideanRingInt:Ru,euclideanRingNumber:qu};var Bu={},_u=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ju=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Du=function(){function n(){}return n.value=new n,n}();Bu={Generic:function(n,e){this.from=n,this.to=e},from:function(n){return n.from},NoArguments:Du,Inl:_u,Inr:Ju,Constructor:function(n){return n}};var Ou,Uu;Uu=function(n){return function(e){var t=e.length;if(0===t)return"";for(var r=e[0],u=1;u<t;u++)r=r+n+e[u];return r}};var xu;xu={IsSymbol:function(n){this.reflectSymbol=n},reflectSymbol:function(n){return n.reflectSymbol}};var Hu,Qu=function(){function n(){}return n.value=new n,n}();Hu={Proxy:Qu};var Wu=function(n){this.genericShowArgs=n},Gu=function(n){this["genericShow'"]=n},zu=new Wu((function(n){return[]})),Ku=function(n){return n.genericShowArgs},Vu=function(n){return n["genericShow'"]};Ou={GenericShow:Gu,"genericShow'":Vu,genericShow:function(n){return function(e){return function(t){return Vu(e)(Bu.from(n)(t))}}},GenericShowArgs:Wu,genericShowArgs:Ku,genericShowArgsNoArguments:zu,genericShowSum:function(n){return function(e){return new Gu((function(t){if(t instanceof Bu.Inl)return Vu(n)(t.value0);if(t instanceof Bu.Inr)return Vu(e)(t.value0);throw new Error("Failed pattern match at Data.Show.Generic (line 26, column 1 - line 28, column 40): "+[t.constructor.name])}))}},genericShowConstructor:function(n){return function(e){return new Gu((function(t){var r=xu.reflectSymbol(e)(Hu.Proxy.value),u=Ku(n)(t);return 0===u.length?r:"("+Uu(" ")(V.append(V.semigroupArray)([r])(u))+")"}))}}};var ju,Xu,Yu,Zu;Xu={throw:function(n){return Zu(Yu(n))},error:Yu=function(n){return new Error(n)},throwException:Zu=function(n){return function(){throw n}}};var $u;$u={unsafePerformEffect:function(n){return n()}};var ni=function(n){return $u.unsafePerformEffect(Xu.throwException(n))};ju={unsafeThrowException:ni,unsafeThrow:function(n){return ni(Xu.error(n))}};var ei,ti,ri,ui,ii,ai,oi,ci=function(){function n(){}return n.value=new n,n}(),fi=function(){function n(){}return n.value=new n,n}(),li=function(){function n(){}return n.value=new n,n}(),vi=function(){function n(){}return n.value=new n,n}(),si=function(){function n(){}return n.value=new n,n}(),di=function(){function n(){}return n.value=new n,n}(),pi=function(){function n(){}return n.value=new n,n}(),mi=function(){function n(){}return n.value=new n,n}(),wi=function(){function n(){}return n.value=new n,n}(),hi=function(){function n(){}return n.value=new n,n}(),bi=function(){function n(){}return n.value=new n,n}(),yi=function(){function n(){}return n.value=new n,n}(),gi=function(){function n(){}return n.value=new n,n}(),Ei=function(){function n(){}return n.value=new n,n}(),Ai=function(){function n(){}return n.value=new n,n}(),Si=function(){function n(){}return n.value=new n,n}(),Mi=function(){function n(){}return n.value=new n,n}(),ki=function(){function n(){}return n.value=new n,n}(),Ti=function(){function n(){}return n.value=new n,n}(),Fi=function(){function n(){}return n.value=new n,n}(),Ii=function(){function n(){}return n.value=new n,n}(),Pi=function(){function n(){}return n.value=new n,n}(),Ci=function(){function n(){}return n.value=new n,n}(),Ni=function(){function n(){}return n.value=new n,n}(),Li=function(){function n(){}return n.value=new n,n}(),qi=function(){function n(){}return n.value=new n,n}(),Ri=function(){function n(){}return n.value=new n,n}(),Bi=function(){function n(){}return n.value=new n,n}(),_i=function(){function n(){}return n.value=new n,n}(),Ji=function(){function n(){}return n.value=new n,n}(),Di=function(n){if(n instanceof li)return 1;if(n instanceof vi)return 2;if(n instanceof si)return 3;if(n instanceof di)return 4;if(n instanceof pi)return 5;if(n instanceof mi)return 6;if(n instanceof wi)return 7;if(n instanceof hi)return 8;throw new Error("Failed pattern match at Domain (line 44, column 16 - line 52, column 15): "+[n.constructor.name])},Oi=function(n){return 1===n?new Q.Just(li.value):2===n?new Q.Just(vi.value):3===n?new Q.Just(si.value):4===n?new Q.Just(di.value):5===n?new Q.Just(pi.value):6===n?new Q.Just(mi.value):7===n?new Q.Just(wi.value):8===n?new Q.Just(hi.value):Q.Nothing.value},Ui=function(n){return 1===n?new Q.Just(Ci.value):2===n?new Q.Just(Ni.value):3===n?new Q.Just(Li.value):4===n?new Q.Just(qi.value):5===n?new Q.Just(Ri.value):6===n?new Q.Just(Bi.value):7===n?new Q.Just(_i.value):8===n?new Q.Just(Ji.value):Q.Nothing.value},xi=new Bu.Generic((function(n){if(n instanceof li)return new Bu.Inl(Bu.NoArguments.value);if(n instanceof vi)return new Bu.Inr(new Bu.Inl(Bu.NoArguments.value));if(n instanceof si)return new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)));if(n instanceof di)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value))));if(n instanceof pi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)))));if(n instanceof mi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value))))));if(n instanceof wi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)))))));if(n instanceof hi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(Bu.NoArguments.value)))))));throw new Error("Failed pattern match at Domain (line 39, column 1 - line 39, column 46): "+[n.constructor.name])}),(function(n){if(n instanceof Bu.Inl)return li.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inl)return vi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inl)return si.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inl)return di.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inl)return pi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inl)return mi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0.value0 instanceof Bu.Inl)return wi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0.value0 instanceof Bu.Inr)return hi.value;throw new Error("Failed pattern match at Domain (line 39, column 1 - line 39, column 46): "+[n.constructor.name])})),Hi=new Nn.Show(Ou.genericShow(xi)(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"One"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Two"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Three"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Four"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Five"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Six"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Seven"}))))(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"Eight"})))))))))))),Qi=new Bu.Generic((function(n){if(n instanceof Ci)return new Bu.Inl(Bu.NoArguments.value);if(n instanceof Ni)return new Bu.Inr(new Bu.Inl(Bu.NoArguments.value));if(n instanceof Li)return new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)));if(n instanceof qi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value))));if(n instanceof Ri)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)))));if(n instanceof Bi)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value))))));if(n instanceof _i)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inl(Bu.NoArguments.value)))))));if(n instanceof Ji)return new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(new Bu.Inr(Bu.NoArguments.value)))))));throw new Error("Failed pattern match at Domain (line 80, column 1 - line 80, column 46): "+[n.constructor.name])}),(function(n){if(n instanceof Bu.Inl)return Ci.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inl)return Ni.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inl)return Li.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inl)return qi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inl)return Ri.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inl)return Bi.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0.value0 instanceof Bu.Inl)return _i.value;if(n instanceof Bu.Inr&&n.value0 instanceof Bu.Inr&&n.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0 instanceof Bu.Inr&&n.value0.value0.value0.value0.value0.value0 instanceof Bu.Inr)return Ji.value;throw new Error("Failed pattern match at Domain (line 80, column 1 - line 80, column 46): "+[n.constructor.name])})),Wi=new Nn.Show(Ou.genericShow(Qi)(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"A"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"B"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"C"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"D"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"E"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"F"}))))(Ou.genericShowSum(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"G"}))))(Ou.genericShowConstructor(Ou.genericShowArgsNoArguments)(new xu.IsSymbol((function(n){return"H"})))))))))))),Gi=new Nn.Show((function(n){return Nn.show(Wi)(n.file)+" "+Nn.show(Hi)(n.rank)})),zi=function(n){if(n instanceof Ci)return 1;if(n instanceof Ni)return 2;if(n instanceof Li)return 3;if(n instanceof qi)return 4;if(n instanceof Ri)return 5;if(n instanceof Bi)return 6;if(n instanceof _i)return 7;if(n instanceof Ji)return 8;throw new Error("Failed pattern match at Domain (line 85, column 16 - line 93, column 11): "+[n.constructor.name])},Ki=new m.Eq((function(n){return function(e){return n instanceof li&&e instanceof li||(n instanceof vi&&e instanceof vi||(n instanceof si&&e instanceof si||(n instanceof di&&e instanceof di||(n instanceof pi&&e instanceof pi||(n instanceof mi&&e instanceof mi||(n instanceof wi&&e instanceof wi||n instanceof hi&&e instanceof hi))))))}})),Vi=new l.Ord((function(n){return Ki}),(function(n){return function(e){if(n instanceof li&&e instanceof li)return T.EQ.value;if(n instanceof li)return T.LT.value;if(e instanceof li)return T.GT.value;if(n instanceof vi&&e instanceof vi)return T.EQ.value;if(n instanceof vi)return T.LT.value;if(e instanceof vi)return T.GT.value;if(n instanceof si&&e instanceof si)return T.EQ.value;if(n instanceof si)return T.LT.value;if(e instanceof si)return T.GT.value;if(n instanceof di&&e instanceof di)return T.EQ.value;if(n instanceof di)return T.LT.value;if(e instanceof di)return T.GT.value;if(n instanceof pi&&e instanceof pi)return T.EQ.value;if(n instanceof pi)return T.LT.value;if(e instanceof pi)return T.GT.value;if(n instanceof mi&&e instanceof mi)return T.EQ.value;if(n instanceof mi)return T.LT.value;if(e instanceof mi)return T.GT.value;if(n instanceof wi&&e instanceof wi)return T.EQ.value;if(n instanceof wi)return T.LT.value;if(e instanceof wi)return T.GT.value;if(n instanceof hi&&e instanceof hi)return T.EQ.value;throw new Error("Failed pattern match at Domain (line 38, column 1 - line 38, column 36): "+[n.constructor.name,e.constructor.name])}})),ji=new m.Eq((function(n){return function(e){return n instanceof bi&&e instanceof bi||(n instanceof yi&&e instanceof yi||(n instanceof gi&&e instanceof gi||(n instanceof Ei&&e instanceof Ei||(n instanceof Ai&&e instanceof Ai||n instanceof Si&&e instanceof Si))))}})),Xi=new m.Eq((function(n){return function(e){return n instanceof Mi&&e instanceof Mi||n instanceof ki&&e instanceof ki}})),Yi=new m.Eq((function(n){return function(e){return m.eq(ji)(n.pieceType)(e.pieceType)&&m.eq(Xi)(n.color)(e.color)}})),Zi=new m.Eq((function(n){return function(e){return n instanceof Ci&&e instanceof Ci||(n instanceof Ni&&e instanceof Ni||(n instanceof Li&&e instanceof Li||(n instanceof qi&&e instanceof qi||(n instanceof Ri&&e instanceof Ri||(n instanceof Bi&&e instanceof Bi||(n instanceof _i&&e instanceof _i||n instanceof Ji&&e instanceof Ji))))))}})),$i=new m.Eq((function(n){return function(e){return m.eq(Zi)(n.file)(e.file)&&m.eq(Ki)(n.rank)(e.rank)}})),na=new m.Eq((function(n){return function(e){return m.eq($i)(n.position)(e.position)&&m.eq(Q.eqMaybe(Yi))(n.currentPiece)(e.currentPiece)}})),ea=new l.Ord((function(n){return Zi}),(function(n){return function(e){if(n instanceof Ci&&e instanceof Ci)return T.EQ.value;if(n instanceof Ci)return T.LT.value;if(e instanceof Ci)return T.GT.value;if(n instanceof Ni&&e instanceof Ni)return T.EQ.value;if(n instanceof Ni)return T.LT.value;if(e instanceof Ni)return T.GT.value;if(n instanceof Li&&e instanceof Li)return T.EQ.value;if(n instanceof Li)return T.LT.value;if(e instanceof Li)return T.GT.value;if(n instanceof qi&&e instanceof qi)return T.EQ.value;if(n instanceof qi)return T.LT.value;if(e instanceof qi)return T.GT.value;if(n instanceof Ri&&e instanceof Ri)return T.EQ.value;if(n instanceof Ri)return T.LT.value;if(e instanceof Ri)return T.GT.value;if(n instanceof Bi&&e instanceof Bi)return T.EQ.value;if(n instanceof Bi)return T.LT.value;if(e instanceof Bi)return T.GT.value;if(n instanceof _i&&e instanceof _i)return T.EQ.value;if(n instanceof _i)return T.LT.value;if(e instanceof _i)return T.GT.value;if(n instanceof Ji&&e instanceof Ji)return T.EQ.value;throw new Error("Failed pattern match at Domain (line 79, column 1 - line 79, column 36): "+[n.constructor.name,e.constructor.name])}})),ta=new l.Ord((function(n){return $i}),(function(n){return function(e){var t=l.compare(ea)(n.file)(e.file);return m.eq(T.eqOrdering)(t)(T.EQ.value)?l.compare(Vi)(n.rank)(e.rank):t}})),ra=new l.Ord((function(n){return na}),(function(n){return function(e){return l.compare(ta)(n.position)(e.position)}})),ua=function(n){return function(e){var t=Br.lookup(ta)(n)(e.tiles);if(t instanceof Q.Just)return t.value0;if(t instanceof Q.Nothing)return ju.unsafeThrow("should never happen that there is an empty key in map");throw new Error("Failed pattern match at Domain (line 197, column 25 - line 199, column 83): "+[t.constructor.name])}},ia=(ri={file:(fu={Pawn:bi,Bishop:yi,Knight:gi,Rook:Ei,Queen:Ai,King:Si,BlackPiece:Mi,WhitePiece:ki,One:li,Two:vi,Three:si,Four:di,Five:pi,Six:mi,Seven:wi,Eight:hi,rankToNumber:Di,numberToRank:Oi,nextRank:function(n){return Oi(Di(n)+1|0)},A:Ci,B:Ni,C:Li,D:qi,E:Ri,F:Bi,G:_i,H:Ji,fileToNumber:zi,numberToFile:Ui,nextFile:function(n){return Ui(zi(n)+1|0)},Piece:function(n){return n},WhiteTile:ci,BlackTile:fi,Position:function(n){return n},tileColor:function(n){return 1===lu.mod(lu.euclideanRingInt)(Di(n.position.rank)+zi(n.position.file)|0)(2)?ci.value:fi.value},movePosition:function(n){return function(e){return Mn.bind(Q.bindMaybe)(Ui(zi(n.file)+e.value0|0))((function(t){return Mn.bind(Q.bindMaybe)(Oi(Di(n.rank)+e.value1|0))((function(n){return tn.pure(Q.applicativeMaybe)(We.wrap()({file:t,rank:n}))}))}))}},Tile:function(n){return n},hasPiece:function(n){return Q.isJust(n.currentPiece)},position:function(n){return n.position},isEmpty:function(n){return Q.isNothing(n.currentPiece)},Normal:Ti,TwoTileMove:Fi,Castling:Ii,LePassant:Pi,Move:function(n){return n},tileAt:ua,pieceAt:function(n){return function(e){return ua(n)(e).currentPiece}},hasMoved:function(n){return n.numberOfMoves>=0},eqPieceType:ji,eqPieceColor:Xi,eqRank:Ki,ordRank:Vi,genericRank:xi,showRank:Hi,eqFile:Zi,ordFile:ea,genericFile:Qi,showFile:Wi,eqPiece:Yi,showPosition:Gi,eqPosition:$i,ordPosition:ta,ordTile:ra,eqTile:na}).H.value,rank:fu.One.value},ui={pieceType:fu.Rook.value,color:fu.WhitePiece.value},ii={position:ri,currentPiece:new Q.Just(ui),numberOfMoves:0},ai={file:fu.A.value,rank:fu.One.value},oi={position:ai,currentPiece:new Q.Just(ui),numberOfMoves:0},Br.insert(fu.ordPosition)(ri)(ii)(Br.insert(fu.ordPosition)(ai)(oi)(Br.empty))),aa=function(){var n={file:fu.G.value,rank:fu.One.value},e={pieceType:fu.Knight.value,color:fu.WhitePiece.value},t={position:n,currentPiece:new Q.Just(e),numberOfMoves:0},r={file:fu.B.value,rank:fu.One.value},u={position:r,currentPiece:new Q.Just(e),numberOfMoves:0};return Br.insert(fu.ordPosition)(n)(t)(Br.insert(fu.ordPosition)(r)(u)(Br.empty))}(),oa=function(){var n={file:fu.F.value,rank:fu.One.value},e={file:fu.C.value,rank:fu.One.value},t={pieceType:fu.Bishop.value,color:fu.WhitePiece.value},r={position:e,currentPiece:new Q.Just(t),numberOfMoves:0},u={position:n,currentPiece:new Q.Just(t),numberOfMoves:0};return Br.insert(fu.ordPosition)(n)(u)(Br.insert(fu.ordPosition)(e)(r)(Br.empty))}(),ca=function(){var n={file:fu.H.value,rank:fu.Eight.value},e={pieceType:fu.Rook.value,color:fu.BlackPiece.value},t={position:n,currentPiece:new Q.Just(e),numberOfMoves:0},r={file:fu.A.value,rank:fu.Eight.value},u={position:r,currentPiece:new Q.Just(e),numberOfMoves:0};return Br.insert(fu.ordPosition)(n)(t)(Br.insert(fu.ordPosition)(r)(u)(Br.empty))}(),fa=function(){var n={file:fu.G.value,rank:fu.Eight.value},e={pieceType:fu.Knight.value,color:fu.BlackPiece.value},t={position:n,currentPiece:new Q.Just(e),numberOfMoves:0},r={file:fu.B.value,rank:fu.Eight.value},u={position:r,currentPiece:new Q.Just(e),numberOfMoves:0};return Br.insert(fu.ordPosition)(n)(t)(Br.insert(fu.ordPosition)(r)(u)(Br.empty))}(),la=function(){var n={file:fu.F.value,rank:fu.Eight.value},e={file:fu.C.value,rank:fu.Eight.value},t={pieceType:fu.Bishop.value,color:fu.BlackPiece.value},r={position:e,currentPiece:new Q.Just(t),numberOfMoves:0},u={position:n,currentPiece:new Q.Just(t),numberOfMoves:0};return Br.insert(fu.ordPosition)(n)(u)(Br.insert(fu.ordPosition)(e)(r)(Br.empty))}(),va=function(){var n={pieceType:fu.Queen.value,color:fu.WhitePiece.value},e={file:fu.D.value,rank:fu.One.value},t={position:e,currentPiece:new Q.Just(n),numberOfMoves:0};return Br.insert(fu.ordPosition)(e)(t)(Br.empty)}(),sa=function(){var n={pieceType:fu.King.value,color:fu.WhitePiece.value},e={file:fu.E.value,rank:fu.One.value},t={position:e,currentPiece:new Q.Just(n),numberOfMoves:0};return Br.insert(fu.ordPosition)(e)(t)(Br.empty)}(),da=function(){var n={pieceType:fu.Queen.value,color:fu.BlackPiece.value},e={file:fu.D.value,rank:fu.Eight.value},t={position:e,currentPiece:new Q.Just(n),numberOfMoves:0};return Br.insert(fu.ordPosition)(e)(t)(Br.empty)}(),pa=function(){var n={pieceType:fu.King.value,color:fu.BlackPiece.value},e={file:fu.E.value,rank:fu.Eight.value},t={position:e,currentPiece:new Q.Just(n),numberOfMoves:0};return Br.insert(fu.ordPosition)(e)(t)(Br.empty)}(),ma=function(n){return function(e){return function(t){if(n instanceof Q.Nothing)return Br.empty;if(n instanceof Q.Just){var r={file:n.value0,rank:e},u={position:r,currentPiece:t,numberOfMoves:0};return Br.insert(fu.ordPosition)(r)(u)(ma(fu.nextFile(n.value0))(e)(t))}throw new Error("Failed pattern match at BoardFactory (line 130, column 1 - line 130, column 77): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},wa=ma(new Q.Just(fu.A.value)),ha=wa(fu.Seven.value)(new Q.Just({pieceType:fu.Pawn.value,color:fu.BlackPiece.value})),ba=function(n){if(n instanceof Q.Nothing)return Br.empty;if(n instanceof Q.Just&&n.value0 instanceof fu.Seven)return Br.empty;if(n instanceof Q.Just&&n.value0 instanceof fu.Eight)return Br.empty;if(n instanceof Q.Just)return Br.union(fu.ordPosition)(wa(n.value0)(Q.Nothing.value))(ba(fu.nextRank(n.value0)));throw new Error("Failed pattern match at BoardFactory (line 120, column 1 - line 120, column 56): "+[n.constructor.name])},ya=ba(new Q.Just(fu.Three.value)),ga=wa(fu.Two.value)(Q.Just.create({pieceType:fu.Pawn.value,color:fu.WhitePiece.value}));ti={createBoard:{tiles:Br.unions(fu.ordPosition)(at.foldableArray)([ya,ha,ga,la,oa,ia,ca,aa,fa,pa,sa,da,va]),previousMove:Q.Nothing.value}};var Ea,Aa,Sa,Ma,ka=function(n){if(n instanceof Q.Nothing)return[];if(n instanceof Q.Just)return[n.value0];throw new Error("Failed pattern match at RulesForMultiMoves (line 50, column 11 - line 52, column 18): "+[n.constructor.name])},Ta=function(n){return function(e){return function(t){return function(r){var u=fu.movePosition(e)(new oe.Tuple(r,t)),i=x.map(Q.functorMaybe)((function(e){return fu.tileAt(e)(n)}))(u);if(Q.maybe(!1)(fu.hasPiece)(i))return[];if(u instanceof Q.Nothing)return iu.trace()("Nothing"+Nn.show(Q.showMaybe(fu.showPosition))(u))((function(n){return[]}));if(u instanceof Q.Just)return iu.trace()("Here"+Nn.show(Q.showMaybe(fu.showPosition))(u))((function(e){return it.cons(u.value0)(Ta(n)(u.value0)(t)(r))}));throw new Error("Failed pattern match at RulesForMultiMoves (line 32, column 17 - line 34, column 135): "+[u.constructor.name])}}}};Ma={moves:function(n){return function(e){return function(t){return Mn.bind(Mn.bindArray)(t)((function(t){return Mn.bind(Mn.bindArray)(Ta(n)(e)(oe.fst(t))(oe.snd(t)))((function(n){return tn.pure(tn.applicativeArray)({position:n,moveType:fu.Normal.value})}))}))}}},attacks:function(n){return function(e){return function(t){return Mn.bind(Mn.bindArray)(ka(fu.pieceAt(e)(n)))((function(r){return Mn.bind(Mn.bindArray)(t)((function(t){return Mn.bind(Mn.bindArray)(ka((u=n,function(n){return function(e){return function(t){return function(r){var i,a=u,o=n,c=e,f=t,l=!1;function v(n,e,t,u,i){var v=fu.movePosition(e)(new oe.Tuple(u,t));if(v instanceof Q.Just){var s=fu.tileAt(v.value0)(n);if(s.currentPiece instanceof Q.Just)return m.notEq(fu.eqPieceColor)(s.currentPiece.value0.color)(i)?(l=!0,new Q.Just(v.value0)):(l=!0,Q.Nothing.value);if(s.currentPiece instanceof Q.Nothing)return a=n,o=v.value0,c=t,f=u,void(r=i);throw new Error("Failed pattern match at RulesForMultiMoves (line 43, column 21 - line 45, column 88): "+[s.currentPiece.constructor.name])}if(v instanceof Q.Nothing)return l=!0,Q.Nothing.value;throw new Error("Failed pattern match at RulesForMultiMoves (line 38, column 9 - line 47, column 31): "+[v.constructor.name])}for(;!l;)i=v(a,o,c,f,r);return i}}}})(e)(oe.fst(t))(oe.snd(t))(r.color)))((function(n){return tn.pure(tn.applicativeArray)({position:n,moveType:fu.Normal.value})}));var u}))}))}}}};var Fa=[new oe.Tuple(1,-1),new oe.Tuple(1,1),new oe.Tuple(-1,1),new oe.Tuple(-1,-1)];Sa={moves:function(n){return function(e){return Ma.moves(n)(e)(Fa)}},attacks:function(n){return function(e){return Ma.attacks(n)(e)(Fa)}}};var Ia,Pa;Pa={moves:function(n){return function(e){return function(t){return Mn.bind(Mn.bindArray)(it.mapMaybe(fu.movePosition(e))(t))((function(e){return Mn.discard(Mn.discardUnit)(Mn.bindArray)(en.guard(en.alternativeArray)(fu.isEmpty(fu.tileAt(e)(n))))((function(n){return tn.pure(tn.applicativeArray)(e)}))}))}}},attacks:function(n){return function(e){return function(t){var r=fu.pieceAt(e)(n);if(r instanceof Q.Just)return Mn.bind(Mn.bindArray)(it.mapMaybe(fu.movePosition(e))(t))((function(e){return Mn.discard(Mn.discardUnit)(Mn.bindArray)(en.guard(en.alternativeArray)(function(n){return function(e){return function(t){var r,u=(r=fu.tileAt(e)(n),Mn.bind(Q.bindMaybe)(r.currentPiece)((function(n){return tn.pure(Q.applicativeMaybe)(m.notEq(fu.eqPieceColor)(t)(n.color))})));return Q.maybe(!1)(an.identity(an.categoryFn))(u)}}}(n)(e)(r.value0.color)))((function(n){return tn.pure(tn.applicativeArray)(e)}))}));if(r instanceof Q.Nothing)return[];throw new Error("Failed pattern match at KnightAndKingRules (line 18, column 39 - line 23, column 18): "+[r.constructor.name])}}}};var Ca=function(n){return function(e){return function(t){var r=l.min(l.ordInt)(fu.rankToNumber(n.rank))(fu.rankToNumber(e.rank)),u=l.max(l.ordInt)(fu.rankToNumber(n.rank))(fu.rankToNumber(e.rank));return t>=r&&t<=u}}},Na=function(n){return function(e){return function(t){return m.eq(fu.eqRank)(n.position.rank)(e.rank)&&Ca(We.wrap()(e))(We.wrap()(t))(fu.fileToNumber(n.position.file))}}},La=function(n){return function(e){return function(t){var r=fu.Position({file:t,rank:e.rank});return Mn.bind(Q.bindMaybe)(Q.Just.create(fu.tileAt(r)(n)))((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(fu.hasMoved(n)))((function(e){return tn.pure(Q.applicativeMaybe)(n)}))}))}}},qa=[new oe.Tuple(0,1),new oe.Tuple(0,-1),new oe.Tuple(1,1),new oe.Tuple(1,0),new oe.Tuple(1,-1),new oe.Tuple(-1,1),new oe.Tuple(-1,0),new oe.Tuple(-1,-1)],Ra=function(n){return function(e){return function(t){return it.all(fu.hasPiece)(it.filter((function(n){return Na(n)(e)(t)}))(it.fromFoldable(br.foldableList)(Br.values(n.tiles))))}}},Ba=function(n){return function(e){return function(t){var r=n?fu.A.value:fu.H.value,u=n?fu.B.value:fu.G.value;return Mn.bind(Q.bindMaybe)(Q.Just.create(fu.tileAt(t)(e)))((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(fu.hasMoved(We.wrap()(n))))((function(t){var i=fu.Position({file:r,rank:n.position.rank});return Mn.bind(Q.bindMaybe)(La(e)(n.position)(i.file))((function(t){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(Ra(e)(n.position)(t.position)))((function(n){var e=fu.Position({file:u,rank:i.rank});return tn.pure(Q.applicativeMaybe)({position:e,moveType:fu.Castling.value})}))}))}))}))}}};Ia={combinations:qa,attacks:function(n){return function(e){return x.map(x.functorArray)((function(n){return{position:n,moveType:fu.Normal.value}}))(Pa.attacks(n)(e)(qa))}},moves:function(n){return function(e){var t=x.map(x.functorArray)((function(n){return{position:n,moveType:fu.Normal.value}}))(Pa.moves(n)(e)(qa)),r=it.mapMaybe((function(t){return t(n)(e)}))([Ba(!0),Ba(!1)]);return V.append(V.semigroupArray)(r)(t)}},castlingMove:Ba,getRookTile:La,areTilesClear:Ra,isTileClear:Na,isBetween:Ca};var _a,Ja=[new oe.Tuple(2,1),new oe.Tuple(1,2),new oe.Tuple(2,-1),new oe.Tuple(1,-2),new oe.Tuple(-2,1),new oe.Tuple(-2,-1),new oe.Tuple(-1,-2),new oe.Tuple(-1,2)];_a={combinations:Ja,moves:function(n){return function(e){return x.map(x.functorArray)((function(n){return{position:n,moveType:fu.Normal.value}}))(Pa.moves(n)(e)(Ja))}},attacks:function(n){return function(e){return x.map(x.functorArray)((function(n){return{position:n,moveType:fu.Normal.value}}))(Pa.attacks(n)(e)(Ja))}}};var Da,Oa=function(n){if(n instanceof fu.WhitePiece)return new oe.Tuple(1,1);if(n instanceof fu.BlackPiece)return new oe.Tuple(1,-1);throw new Error("Failed pattern match at PawnRules (line 58, column 25 - line 60, column 31): "+[n.constructor.name])},Ua=function(n){return function(e){return function(t){return function(r){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(r(fu.tileAt(e)(n))))((function(r){return Mn.bind(Q.bindMaybe)(fu.pieceAt(e)(n))((function(r){return Mn.bind(Q.bindMaybe)(function(n){return function(e){return function(t){return function(r){var u=function(){if(t instanceof fu.WhitePiece)return yu.add(yu.semiringInt);if(t instanceof fu.BlackPiece)return wu.sub(wu.ringInt);throw new Error("Failed pattern match at PawnRules (line 34, column 14 - line 36, column 30): "+[t.constructor.name])}();return Mn.bind(Q.bindMaybe)(fu.numberToRank(u(fu.rankToNumber(e.rank))(r)))((function(t){var r=We.wrap()({rank:t,file:e.file});return tn.pure(Q.applicativeMaybe)(fu.tileAt(r)(n))}))}}}}(n)(e)(r.color)(t))((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(Q.isNothing(n.currentPiece)))((function(e){return tn.pure(Q.applicativeMaybe)(n.position)}))}))}))}))}}}},xa=function(n){return function(e){return x.map(Q.functorMaybe)((function(n){return{position:n,moveType:fu.Normal.value}}))(Ua(n)(e)(1)((function(n){return!0})))}},Ha=function(n){return function(e){return x.map(Q.functorMaybe)((function(n){return{position:n,moveType:fu.TwoTileMove.value}}))(Ua(n)(e)(2)((t=We.unwrap(),function(n){return 0===t(n).numberOfMoves})));var t}},Qa=function(n){if(n instanceof fu.WhitePiece)return new oe.Tuple(-1,1);if(n instanceof fu.BlackPiece)return new oe.Tuple(-1,-1);throw new Error("Failed pattern match at PawnRules (line 53, column 24 - line 55, column 34): "+[n.constructor.name])},Wa=function(n){return function(e){return function(t){return function(r){return function(u){var i=m.eq(fu.eqPieceColor)(t)(fu.WhitePiece.value)?fu.Seven.value:fu.Two.value,a=m.eq(fu.eqRank)(e.to.rank)(r.rank),o=m.eq(fu.eqRank)(e.from.rank)(i),c=m.eq(fu.eqFile)(e.to.file)(u),f=function(n){return function(e){return function(t){var r=fu.tileAt(t.to)(n);return Q.maybe(!1)((function(n){return m.eq(fu.eqPieceType)(n.pieceType)(fu.Pawn.value)&&m.notEq(fu.eqPieceColor)(n.color)(e)}))(r.currentPiece)}}}(n)(t)(We.wrap()(e));return a&&o&&c&&f}}}}},Ga=function(n){return function(e){return function(t){var r=t?-1:1;return x.map(Q.functorMaybe)((function(n){return{position:n,moveType:fu.LePassant.value}}))(function(n){return function(e){return function(t){return Mn.bind(Q.bindMaybe)(fu.numberToFile(fu.fileToNumber(e.file)+t|0))((function(t){var r={file:t,rank:e.rank};return Mn.bind(Q.bindMaybe)(n.previousMove)((function(u){return Mn.bind(Q.bindMaybe)(fu.pieceAt(We.wrap()(e))(n))((function(i){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(Wa(n)(u)(i.color)(We.wrap()(e))(t)))((function(n){var e=m.eq(fu.eqPieceColor)(i.color)(fu.WhitePiece.value)?1:-1;return Mn.bind(Q.bindMaybe)(fu.numberToRank(fu.rankToNumber(r.rank)+e|0))((function(n){return tn.pure(Q.applicativeMaybe)(We.wrap()({rank:n,file:r.file}))}))}))}))}))}))}}}(n)(e)(r))}}},za=function(n){return function(e){return it.head(it.mapMaybe((function(t){return Ga(n)(e)(t)}))([!0,!1]))}},Ka=function(n){return function(e){return function(t){var r,u=fu.tileAt(e)(n);return Mn.bind(Q.bindMaybe)(x.map(Q.functorMaybe)((r=We.unwrap(),function(n){return r(n).color}))(u.currentPiece))((function(r){var u=t(r);return Mn.bind(Q.bindMaybe)(fu.movePosition(e)(u))((function(e){var t=fu.tileAt(e)(n);return Mn.bind(Q.bindMaybe)(t.currentPiece)((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.notEq(fu.eqPieceColor)(n.color)(r)))((function(n){return tn.pure(Q.applicativeMaybe)(e)}))}))}))}))}}},Va=function(n){return function(e){return x.map(Q.functorMaybe)((function(n){return{position:n,moveType:fu.Normal.value}}))(Ka(n)(e)(Qa))}},ja=function(n){return function(e){return x.map(Q.functorMaybe)((function(n){return{position:n,moveType:fu.Normal.value}}))(Ka(n)(e)(Oa))}};Da={moves:function(n){return function(e){return it.mapMaybe(an.identity(an.categoryFn))([xa(n)(e),Ha(n)(e)])}},attacks:function(n){return function(e){return it.mapMaybe(an.identity(an.categoryFn))(x.map(x.functorArray)((function(t){return t(n)(e)}))([Va,ja,za]))}}};var Xa,Ya=[new oe.Tuple(1,-1),new oe.Tuple(1,1),new oe.Tuple(-1,1),new oe.Tuple(1,0),new oe.Tuple(0,1),new oe.Tuple(-1,0),new oe.Tuple(0,-1),new oe.Tuple(-1,-1)];Xa={combinations:Ya,moves:function(n){return function(e){return Ma.moves(n)(e)(Ya)}},attacks:function(n){return function(e){return Ma.attacks(n)(e)(Ya)}}};var Za,$a=[new oe.Tuple(1,0),new oe.Tuple(0,1),new oe.Tuple(-1,0),new oe.Tuple(0,-1)];Za={combinations:$a,moves:function(n){return function(e){return Ma.moves(n)(e)($a)}},attacks:function(n){return function(e){return Ma.attacks(n)(e)($a)}}};var no=function(n){return function(e){return function(t){if(t instanceof fu.Pawn)return Da.moves(n)(e);if(t instanceof fu.Bishop)return Sa.moves(n)(e);if(t instanceof fu.Knight)return _a.moves(n)(e);if(t instanceof fu.Rook)return Za.moves(n)(e);if(t instanceof fu.Queen)return Xa.moves(n)(e);if(t instanceof fu.King)return Ia.moves(n)(e);throw new Error("Failed pattern match at Rules (line 17, column 34 - line 23, column 36): "+[t.constructor.name])}}},eo=function(n){return function(e){return function(t){if(t instanceof fu.Pawn)return Da.attacks(n)(e);if(t instanceof fu.Bishop)return Sa.attacks(n)(e);if(t instanceof fu.Knight)return _a.attacks(n)(e);if(t instanceof fu.Rook)return Za.attacks(n)(e);if(t instanceof fu.Queen)return Xa.attacks(n)(e);if(t instanceof fu.King)return Ia.attacks(n)(e);throw new Error("Failed pattern match at Rules (line 26, column 36 - line 32, column 38): "+[t.constructor.name])}}};Aa={moves:no,attacks:eo,allMoves:function(n){return function(e){var t,r=(t=fu.tileAt(e)(n),Mn.bind(Q.bindMaybe)(t.currentPiece)((function(t){var r=Mn.bind(Mn.bindArray)([no,eo])((function(r){return r(n)(e)(t.pieceType)}));return tn.pure(Q.applicativeMaybe)(r)})));return Q.maybe([])(an.identity(an.categoryFn))(r)}}};var to=function(n){return function(e){var t,r=it.fromFoldable(br.foldableList)(Br.values(n.tiles));return Mn.bind(Mn.bindArray)(it.mapMaybe((t=e,function(n){return Mn.bind(Q.bindMaybe)(n.currentPiece)((function(e){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.notEq(fu.eqPieceColor)(e.color)(t)))((function(t){return tn.pure(Q.applicativeMaybe)(new oe.Tuple(e,We.wrap()(n)))}))}))}))(r))((function(e){var t=oe.snd(e),r=oe.fst(e);return x.map(x.functorArray)((function(n){return n.position}))(Aa.attacks(n)(t.position)(r.pieceType))}))}},ro=function(n){return function(e){return(t=function(e){return function(n){return n.pieceType instanceof fu.King}(We.wrap()(e))&&m.eq(fu.eqPieceColor)(e.color)(n)},function(n){if(n instanceof Q.Just)return t(n.value0);if(n instanceof Q.Nothing)return!1;throw new Error("Failed pattern match at CheckRules (line 52, column 14 - line 54, column 24): "+[n.constructor.name])})(e.currentPiece);var t}};Ea={isKingChecked:function(n){return function(e){var t=Mn.bind(Q.bindMaybe)(it.head(it.filter(ro(e))(it.fromFoldable(br.foldableList)(Br.values(n.tiles)))))((function(e){return Mn.bind(Q.bindMaybe)(e.currentPiece)((function(t){var r=to(n)(t.color);return tn.pure(Q.applicativeMaybe)(it.elem(fu.eqPosition)(e.position)(r))}))}));return Q.maybe(!1)(an.identity(an.categoryFn))(t)}}};var uo=function(){function n(){}return n.value=new n,n}(),io=function(){function n(){}return n.value=new n,n}(),ao=function(){function n(){}return n.value=new n,n}(),oo=function(){function n(){}return n.value=new n,n}(),co=function(){function n(){}return n.value=new n,n}(),fo=function(n){return n},lo=function(n){return function(e){return function(t){return{tiles:Br.alter(fu.ordPosition)((function(e){return new Q.Just(n)}))(fu.position(n))(t.tiles),previousMove:new Q.Just(e)}}}},vo=function(n){return function(e){return Mn.bind(Q.bindMaybe)(e.currentPiece)((function(t){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.eq(fu.eqPieceColor)(t.color)(n)))((function(n){return tn.pure(Q.applicativeMaybe)(We.wrap()(e))}))}))}},so=function(n){return function(e){var t=fu.tileAt(n.from)(e.currentBoard),r=fu.tileAt(n.to)(e.currentBoard);return Mn.bind(Q.bindMaybe)(t.currentPiece)((function(u){var i=fu.Tile({position:t.position,currentPiece:Q.Nothing.value,numberOfMoves:t.numberOfMoves+1|0}),a=fu.Tile({position:r.position,currentPiece:new Q.Just(u),numberOfMoves:r.numberOfMoves+1|0});return tn.pure(Q.applicativeMaybe)(lo(a)(We.wrap()(n))(lo(i)(We.wrap()(n))(e.currentBoard)))}))}},po={previousBoard:Q.Nothing.value,currentBoard:ti.createBoard,turn:uo.value,gameStatus:ao.value},mo=function(n){return function(e){var t=fu.tileAt(n.from)(e.currentBoard),r=fu.tileAt(n.to)(e.currentBoard);return Mn.bind(Q.bindMaybe)(t.currentPiece)((function(u){var i=m.eq(fu.eqPieceColor)(u.color)(fu.WhitePiece.value)?-1:1,a=fu.Tile({position:t.position,currentPiece:Q.Nothing.value,numberOfMoves:t.numberOfMoves+1|0}),o=fu.Tile({position:r.position,currentPiece:new Q.Just(u),numberOfMoves:r.numberOfMoves+1|0});return Mn.bind(Q.bindMaybe)(fu.movePosition(n.to)(new oe.Tuple(0,i)))((function(t){var r,u,i=fu.tileAt(t)(e.currentBoard),c=fu.Tile({position:i.position,currentPiece:Q.Nothing.value,numberOfMoves:i.numberOfMoves});return tn.pure(Q.applicativeMaybe)((r=lo(c)(We.wrap()(n)),u=lo(o)(We.wrap()(n)),function(n){return r(u(n))})(lo(a)(We.wrap()(n))(e.currentBoard)))}))}))}},wo=new m.Eq((function(n){return function(e){return n instanceof uo&&e instanceof uo||n instanceof io&&e instanceof io}})),ho=new m.Eq((function(n){return function(e){return n instanceof ao&&e instanceof ao||(n instanceof oo&&e instanceof oo||n instanceof co&&e instanceof co)}})),bo=function(n){return function(e){fu.tileAt(We.wrap()(n.to))(e.currentBoard);var t=fu.tileAt(We.wrap()(n.from))(e.currentBoard),r=m.eq(fu.eqFile)(n.to.file)(fu.B.value)?fu.A.value:fu.H.value,u=m.eq(fu.eqFile)(n.to.file)(fu.B.value)?fu.C.value:fu.F.value,i=fu.tileAt({file:r,rank:n.from.rank})(e.currentBoard),a=fu.Tile({position:t.position,currentPiece:Q.Nothing.value,numberOfMoves:t.numberOfMoves+1|0});return Mn.bind(Q.bindMaybe)(t.currentPiece)((function(r){return Mn.bind(Q.bindMaybe)(i.currentPiece)((function(o){var c,f,l,v=fu.Tile({position:t.position,currentPiece:new Q.Just(r),numberOfMoves:t.numberOfMoves+1|0}),s={file:u,rank:n.from.rank},d=fu.tileAt(We.wrap()(s))(e.currentBoard),p=fu.Tile({position:d.position,currentPiece:new Q.Just(o),numberOfMoves:d.numberOfMoves+1|0});return tn.pure(Q.applicativeMaybe)((c=lo(p)(We.wrap()(n)),f=lo(We.wrap()(i))(We.wrap()(n)),l=lo(v)(We.wrap()(n)),function(n){return c(f(l(n)))})(lo(a)(We.wrap()(n))(e.currentBoard)))}))}))}},yo=function(n){return function(e){return Mn.bind(Q.bindMaybe)(function(){if(n.moveType instanceof fu.Normal)return so(We.wrap()(n))(e);if(n.moveType instanceof fu.TwoTileMove)return so(We.wrap()(n))(e);if(n.moveType instanceof fu.Castling)return bo(We.wrap()(n))(e);if(n.moveType instanceof fu.LePassant)return mo(We.wrap()(n))(e);throw new Error("Failed pattern match at Game (line 109, column 18 - line 113, column 64): "+[n.moveType.constructor.name])}())((function(t){var r=fu.tileAt(n.from)(e.currentBoard);return Mn.bind(Q.bindMaybe)(r.currentPiece)((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(!Ea.isKingChecked(t)(n.color)))((function(n){return tn.pure(Q.applicativeMaybe)(t)}))}))}))}},go=function(n){return function(e){return function(t){var r=Aa.allMoves(t.currentBoard)(n);return Mn.bind(Q.bindMaybe)(Q.Just.create(fu.tileAt(e)(t.currentBoard)))((function(e){return Mn.bind(Q.bindMaybe)(it.find((function(n){return m.eq(fu.eqPosition)(e.position)(n.position)}))(r))((function(r){var u={from:fu.tileAt(n)(t.currentBoard).position,to:e.position,moveType:r.moveType};return Mn.bind(Q.bindMaybe)(yo(u)(We.wrap()(t)))((function(n){var e=m.eq(wo)(t.turn)(uo.value)?io.value:uo.value;return tn.pure(Q.applicativeMaybe)({previousBoard:new Q.Just(t.currentBoard),currentBoard:n,turn:e,gameStatus:ao.value})}))}))}))}}},Eo=function(n){return function(e){return{from:e.position,to:x.map(x.functorArray)((function(n){return n.position}))(Aa.allMoves(n)(e.position))}}},Ao=function(n){return function(e){var t=it.fromFoldable(br.foldableList)(Br.values(n.currentBoard.tiles)),r=it.mapMaybe(vo(e))(t),u=Mn.bind(Mn.bindArray)(x.map(x.functorArray)(Eo(n.currentBoard))(r))((function(e){return Mn.bind(Mn.bindArray)(e.to)((function(t){return Q.maybe([])((function(n){return[n]}))(go(e.from)(t)(We.wrap()(n)))}))}));return it.all((function(n){return Ea.isKingChecked(n.currentBoard)(e)}))(u)}},So=function(n){return function(e){return Ea.isKingChecked(n.currentBoard)(e)&&Ao(We.wrap()(n))(e)}};ei={WhiteTurn:uo,BlackTurn:io,Game:fo,makeGame:po,Cont:ao,Finished:oo,Checking:co,isKingMated:So,updateCheckOrMate:function(n){if(m.eq(ho)(n.gameStatus)(co.value)){var e=So(We.wrap()(n))(m.eq(wo)(n.turn)(uo.value)?fu.WhitePiece.value:fu.BlackPiece.value),t={previousBoard:n.previousBoard,currentBoard:n.currentBoard,turn:n.turn,gameStatus:e?oo.value:ao.value};return We.wrap()(t)}return We.wrap()(n)},move:function(n){return function(e){return function(t){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.notEq(ho)(t.gameStatus)(oo.value)))((function(r){var u=fu.tileAt(n)(t.currentBoard);return Mn.bind(Q.bindMaybe)(u.currentPiece)((function(r){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.eq(wo)(t.turn)(uo.value)?m.eq(fu.eqPieceColor)(r.color)(fu.WhitePiece.value):m.eq(fu.eqPieceColor)(r.color)(fu.BlackPiece.value)))((function(r){var u=Aa.allMoves(t.currentBoard)(n);return Mn.bind(Q.bindMaybe)(Q.Just.create(fu.tileAt(e)(t.currentBoard)))((function(e){return Mn.bind(Q.bindMaybe)(it.find((function(n){return m.eq(fu.eqPosition)(e.position)(n.position)}))(u))((function(r){var u=fu.tileAt(n)(t.currentBoard);return Mn.bind(Q.bindMaybe)(u.currentPiece)((function(n){return Mn.discard(Mn.discardUnit)(Q.bindMaybe)(en.guard(Q.alternativeMaybe)(m.eq(fu.eqPieceColor)(n.color)(fu.WhitePiece.value)?m.eq(wo)(t.turn)(uo.value):m.eq(wo)(t.turn)(io.value)))((function(n){var i={from:u.position,to:e.position,moveType:r.moveType};return Mn.bind(Q.bindMaybe)(yo(i)(We.wrap()(t)))((function(n){var e=m.eq(wo)(t.turn)(uo.value)?io.value:uo.value;return tn.pure(Q.applicativeMaybe)({previousBoard:new Q.Just(t.currentBoard),currentBoard:n,turn:e,gameStatus:co.value})}))}))}))}))}))}))}))}))}}},moveNoTurn:go,boardAfterMove:yo,normalMove:so,castlingMove:bo,lePassantMove:mo,updateBoard:lo,cannotBeDefended:Ao,allPossibleMoves:Eo,tileWithPiece:vo,eqTurn:wo,eqGameStatus:ho};var Mo={},ko={},To={};To={mkExists:ze.unsafeCoerce,runExists:ze.unsafeCoerce};var Fo=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Io=function(n){return n},Po=function(n){return function(e){return To.mkExists(new Fo(n,e))}},Co=new x.Functor((function(n){return function(e){return To.runExists((function(e){return Po((function(t){return n(e.value0(t))}))(e.value1)}))(e)}})),No=Po(an.identity(an.categoryFn));ko={Coyoneda:Io,coyoneda:Po,unCoyoneda:function(n){return function(e){return To.runExists((function(e){return n(e.value0)(e.value1)}))(e)}},liftCoyoneda:No,functorCoyoneda:Co};var Lo,qo,Ro,Bo,_o,Jo,Do={};Bo=function(n){return function(){return n}},_o=function(n){return function(e){return function(){return e(n())()}}},Jo=function(n){return function(){for(;!n(););}};var Oo=new Le.Monad((function(n){return Ho}),(function(n){return Uo})),Uo=new Mn.Bind((function(n){return xo}),_o),xo=new rn.Apply((function(n){return Qo}),Le.ap(Oo)),Ho=new tn.Applicative((function(n){return xo}),Bo),Qo=new x.Functor(tn.liftA1(Ho));Ro={functorEffect:Qo,applyEffect:xo,applicativeEffect:Ho,bindEffect:Uo,monadEffect:Oo,untilE:Jo};var Wo={},Go=function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}},zo=function(n){return Go((function(e){var t=n(e);return{state:t,value:t}}))};Wo={"modify'":Go,modify:zo,modify_:function(n){return function(e){return x.void(Ro.functorEffect)(zo(n)(e))}},new:function(n){return function(){return{value:n}}},read:function(n){return function(){return n.value}},write:function(n){return function(e){return function(){e.value=n}}}};var Ko=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Vo=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),jo=function(n,e){this.Monad0=n,this.tailRecM=e},Xo=new jo((function(n){return Ro.monadEffect}),(function(n){return function(e){var t=function(n){if(n instanceof Vo)return n.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 113, column 30 - line 113, column 44): "+[n.constructor.name])};return function(){var r=Mn.bindFlipped(Ro.bindEffect)(Wo.new)(n(e))();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Ro.untilE((function(){var e=Wo.read(r)();if(e instanceof Ko){var t=n(e.value0)();Wo.write(t)(r)();return!1}if(e instanceof Vo)return!0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 104, column 22 - line 109, column 28): "+[e.constructor.name])})))((function(n){return x.map(Ro.functorEffect)(t)(Wo.read(r))}))()}}}));Do={Loop:Ko,Done:Vo,MonadRec:jo,tailRecM:function(n){return n.tailRecM},monadRecEffect:Xo};var Yo,Zo,$o=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),nc=new $o(br.Nil.value,br.Nil.value);Zo={CatQueue:$o,empty:nc,null:function(n){return n.value0 instanceof br.Nil&&n.value1 instanceof br.Nil},snoc:function(n){return function(e){return new $o(n.value0,new br.Cons(e,n.value1))}},uncons:function(n){var e,t=!1;function r(e){if(e.value0 instanceof br.Nil&&e.value1 instanceof br.Nil)return t=!0,Q.Nothing.value;if(!(e.value0 instanceof br.Nil)){if(e.value0 instanceof br.Cons)return t=!0,new Q.Just(new oe.Tuple(e.value0.value0,new $o(e.value0.value1,e.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 83, column 1 - line 83, column 63): "+[e.constructor.name])}n=new $o(hr.reverse(e.value1),br.Nil.value)}for(;!t;)e=r(n);return e}};var ec=function(){function n(){}return n.value=new n,n}(),tc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),rc=function(n){return function(e){if(n instanceof ec)return e;if(e instanceof ec)return n;if(n instanceof tc)return new tc(n.value0,Zo.snoc(n.value1)(e));throw new Error("Failed pattern match at Data.CatList (line 109, column 1 - line 109, column 54): "+[n.constructor.name,e.constructor.name])}},uc=function(n){return function(e){return function(t){var r;return(r=t,function(t){var u,i=r,a=!1;function o(r,u){var o,c=Zo.uncons(r);if(c instanceof Q.Nothing)return a=!0,(o=function(n){return function(e){return e(n)}},function(n){return function(e){var t,r=o,u=n,i=!1;function a(n,t,a){if(a instanceof br.Nil)return i=!0,t;if(a instanceof br.Cons)return r=n,u=n(t)(a.value0),void(e=a.value1);throw new Error("Failed pattern match at Data.CatList (line 125, column 3 - line 125, column 59): "+[n.constructor.name,t.constructor.name,a.constructor.name])}for(;!i;)t=a(r,u,e);return t}})(e)(u);if(c instanceof Q.Just)return i=c.value0.value1,void(t=new br.Cons(n(c.value0.value0),u));throw new Error("Failed pattern match at Data.CatList (line 121, column 14 - line 123, column 67): "+[c.constructor.name])}for(;!a;)u=o(i,t);return u})(br.Nil.value)}}},ic=ec.value,ac=rc,oc=new V.Semigroup(ac);Yo={CatNil:ec,CatCons:tc,empty:ic,append:ac,snoc:function(n){return function(e){return ac(n)(new tc(e,Zo.empty))}},uncons:function(n){if(n instanceof ec)return Q.Nothing.value;if(n instanceof tc)return new Q.Just(new oe.Tuple(n.value0,Zo.null(n.value1)?ec.value:uc(rc)(ec.value)(n.value1)));throw new Error("Failed pattern match at Data.CatList (line 100, column 1 - line 100, column 61): "+[n.constructor.name])},semigroupCatList:oc};var cc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),fc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),lc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),vc=function(n){return new cc(n,Yo.empty)},sc=new Le.Monad((function(n){return wc}),(function(n){return pc})),dc=new x.Functor((function(n){return function(e){return Mn.bindFlipped(pc)((t=tn.pure(wc),function(e){return t(n(e))}))(e);var t}})),pc=new Mn.Bind((function(n){return mc}),(function(n){return function(e){return new cc(n.value0,Yo.snoc(n.value1)(e))}})),mc=new rn.Apply((function(n){return dc}),Le.ap(sc)),wc=new tn.Applicative((function(n){return mc}),(function(n){return vc(fc.create(n))}));qo={liftF:function(n){return vc(new lc(n,(e=tn.pure(wc),function(n){return e(n)})));var e},foldFree:function(n){return function(e){return Do.tailRecM(n)((function(t){var r=function(n){var e,t=!1;function r(e){var r=function(n){return function(e){return new cc(n.value0,V.append(Yo.semigroupCatList)(n.value1)(e))}};if(e.value0 instanceof fc){var u=Yo.uncons(e.value1);if(u instanceof Q.Nothing)return t=!0,new fc(e.value0.value0);if(u instanceof Q.Just)return void(n=r((0,u.value0.value0)(e.value0.value0))(u.value0.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[u.constructor.name])}if(e.value0 instanceof lc)return t=!0,new lc(e.value0.value0,(function(n){return r(e.value0.value1(n))(e.value1)}));throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[e.value0.constructor.name])}for(;!t;)e=r(n);return e}(t);if(r instanceof fc)return x.map(n.Monad0().Bind1().Apply0().Functor0())(Do.Done.create)(tn.pure(n.Monad0().Applicative0())(r.value0));if(r instanceof lc)return x.map(n.Monad0().Bind1().Apply0().Functor0())((function(n){return Do.Loop.create(r.value1(n))}))(e(r.value0));throw new Error("Failed pattern match at Control.Monad.Free (line 158, column 10 - line 160, column 37): "+[r.constructor.name])}))}},freeFunctor:dc,freeBind:pc,freeApplicative:wc,freeApply:mc,freeMonad:sc};var hc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),bc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),yc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),gc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ec=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ac=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Sc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Mc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),kc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Tc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Fc=function(n){return n},Ic=l.ordInt,Pc=l.ordInt,Cc=qo.freeMonad,Nc=new pr.MonadState((function(n){return Cc}),(function(n){return qo.liftF(hc.create(n))}));Lo={State:hc,Subscribe:bc,Unsubscribe:yc,Lift:gc,ChildQuery:Ec,Raise:Ac,Par:Sc,Fork:Mc,Kill:kc,GetRef:Tc,HalogenM:Fc,HalogenAp:function(n){return n},SubscriptionId:function(n){return n},ForkId:function(n){return n},functorHalogenM:qo.freeFunctor,applicativeHalogenM:qo.freeApplicative,bindHalogenM:qo.freeBind,monadHalogenM:Cc,monadStateHalogenM:Nc,ordSubscriptionId:Ic,ordForkId:Pc};var Lc={},qc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Rc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Bc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),_c=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Jc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}();Lc={Initialize:qc,Finalize:Rc,Receive:Bc,Action:_c,Query:Jc};var Dc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Oc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Uc=ze.unsafeCoerce,xc=ze.unsafeCoerce,Hc=ze.unsafeCoerce,Qc={handleAction:H.const(tn.pure(Lo.applicativeHalogenM)(W.unit)),handleQuery:H.const(tn.pure(Lo.applicativeHalogenM)(Q.Nothing.value)),receive:H.const(Q.Nothing.value),initialize:Q.Nothing.value,finalize:Q.Nothing.value};Mo={mkComponent:Hc,unComponent:xc,mkEval:function(n){return function(e){if(e instanceof Lc.Initialize)return x.voidLeft(Lo.functorHalogenM)(at.traverse_(Lo.applicativeHalogenM)(at.foldableMaybe)(n.handleAction)(n.initialize))(e.value0);if(e instanceof Lc.Finalize)return x.voidLeft(Lo.functorHalogenM)(at.traverse_(Lo.applicativeHalogenM)(at.foldableMaybe)(n.handleAction)(n.finalize))(e.value0);if(e instanceof Lc.Receive)return x.voidLeft(Lo.functorHalogenM)(at.traverse_(Lo.applicativeHalogenM)(at.foldableMaybe)(n.handleAction)(n.receive(e.value0)))(e.value1);if(e instanceof Lc.Action)return x.voidLeft(Lo.functorHalogenM)(n.handleAction(e.value0))(e.value1);if(e instanceof Lc.Query)return ko.unCoyoneda((function(t){var r=x.map(Lo.functorHalogenM)(Q.maybe(e.value1(W.unit))(t));return function(e){return r(n.handleQuery(e))}}))(e.value0);throw new Error("Failed pattern match at Halogen.Component (line 182, column 15 - line 192, column 70): "+[e.constructor.name])}},defaultEval:Qc,ComponentSlot:Dc,ThunkSlot:Oc,unComponentSlot:Uc};var Wc,Gc={},zc=function(n){return function(t){if(n instanceof e.Plain&&t instanceof e.Plain)return[new ft.Right(new oe.Tuple(n.value0,t.value0))];if(n instanceof e.Prefixed&&t instanceof e.Plain)return x.map(x.functorArray)((function(n){return ft.Right.create(new oe.Tuple(n.value0+n.value1,t.value0))}))(n.value0);if(n instanceof e.Plain&&t instanceof e.Prefixed)return x.map(x.functorArray)((function(e){return ft.Right.create(new oe.Tuple(n.value0,e.value0+e.value1))}))(t.value0);if(n instanceof e.Prefixed&&t instanceof e.Prefixed)return x.map(x.functorArray)((function(n){return Q.maybe(new ft.Left(n.value0+n.value1))((e=oe.Tuple.create(n.value0+n.value1),function(t){return ft.Right.create(e((r=t,n.value0+r)));var r}))(at.lookup(at.foldableArray)(m.eqString)(n.value0)(t.value0));var e}))(n.value0);throw new Error("Failed pattern match at CSS.Render (line 156, column 1 - line 156, column 80): "+[n.constructor.name,t.constructor.name])}};Wc={collect:function(n){return zc(n.value0)(n.value1)},"collect'":zc};var Kc;Kc={joinWith:function(n){return function(e){return e.join(n)}}};var Vc,jc,Xc,Yc={};Vc=function(n){return n()},jc=function(n){return function(e){return function(t){return function(r){var u=t;function i(n){return function(t){return e(t)(n)(r[n])}}for(var a in r)hasOwnProperty.call(r,a)&&(u=n(u)(i(a)));return u}}}},Xc=function(n,e,t,r){return t in r?e(r[t]):n};var Zc,$c,nf,ef;$c=function(n){return function(){return n}},nf=function(n){return function(e){return function(){return e(n())()}}},ef=function(n){return function(e){return function(){for(var t=0,r=n.length;t<r;t++)e(n[t])()}}};var tf=new x.Functor((function(n){return function(e){return function(){return n(e())}}})),rf=new Le.Monad((function(n){return of}),(function(n){return uf})),uf=new Mn.Bind((function(n){return af}),nf),af=new rn.Apply((function(n){return tf}),Le.ap(rf)),of=new tn.Applicative((function(n){return af}),$c);Zc={functorST:tf,applyST:af,applicativeST:of,bindST:uf,monadST:rf,foreach:ef};var cf;cf={new:function(){return{}},poke:function(n){return function(e){return function(t){return function(){return t[n]=e,t}}}}};var ff={mkFn2:function(n){return function(e,t){return n(e)(t)}},mkFn4:function(n){return function(e,t,r,u){return n(e)(t)(r)(u)}},runFn2:function(n){return function(e){return function(t){return n(e,t)}}},runFn3:function(n){return function(e){return function(t){return function(r){return n(e,t,r)}}}},runFn4:function(n){return function(e){return function(t){return function(r){return function(u){return n(e,t,r,u)}}}}}}.runFn4(Xc)(Q.Nothing.value)(Q.Just.create),lf=jc(H.applyFlipped);Yc={lookup:ff,fromFoldable:function(n){return function(e){return Vc((function(){var t=cf.new();return Mn.discard(Mn.discardUnit)(Zc.bindST)(Zc.foreach(it.fromFoldable(n)(e))((function(n){return x.void(Zc.functorST)(cf.poke(n.value0)(n.value1)(t))})))((function(n){return tn.pure(Zc.applicativeST)(t)}))()}))}},fold:lf,foldMap:function(n){return function(e){return lf((function(t){return function(r){return function(u){return V.append(n.Semigroup0())(t)(e(r)(u))}}}))(Re.mempty(n))}},runST:Vc};var vf,sf,df={},pf={},mf={},wf={};vf=function(n,e,t){return null==n?e:t(n)},sf=function(n){return n};var hf=Q.maybe(null)(sf);wf={toMaybe:function(n){return vf(n,Q.Nothing.value,Q.Just.create)},toNullable:hf,null:null,notNull:sf};var bf;bf={typeOf:function(n){return typeof n}};var yf={},gf=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Ef=ze.unsafeCoerce,Af=ze.unsafeCoerce,Sf=Ef((function(n){return n.value0}));yf={Step:gf,mkStep:Af,unStep:Ef,extract:Sf,step:function(n,e){return n.value2(n.value1,e)},halt:function(n){return n.value3(n.value1)}};var Mf,kf,Tf={};Tf={newMutMap:cf.new,pokeMutMap:kf=function(n,e,t){t[n]=e},unsafeFreeze:ze.unsafeCoerce,unsafeLookup:Mf=function(n,e){return e[n]},unsafeGetAny:Mf,unsafeHasAny:function(n,e){return e.hasOwnProperty(n)},unsafeSetAny:kf,forE:function(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e(r,n[r]));return t},forEachE:function(n,e){for(var t=0;t<n.length;t++)e(n[t])},forInE:function(n,e){for(var t=Object.keys(n),r=0;r<t.length;r++){var u=t[r];e(u,n[u])}},diffWithIxE:function(n,e,t,r,u){for(var i=[],a=n.length,o=e.length,c=0;;){if(c<a)c<o?i.push(t(c,n[c],e[c])):r(c,n[c]);else{if(!(c<o))break;i.push(u(c,e[c]))}c++}return i},diffWithKeyAndIxE:function(n,e,t,r,u,i){for(var a={},o=0;o<e.length;o++){var c=e[o],f=t(c);n.hasOwnProperty(f)?a[f]=r(f,o,n[f],c):a[f]=i(f,o,c)}for(var f in n)f in a||u(f,n[f]);return a},strMapWithIxE:function(n,e,t){for(var r={},u=0;u<n.length;u++){var i=n[u],a=e(i);r[a]=t(a,u,i)}return r},refEq:function(n,e){return n===e},createTextNode:function(n,e){return e.createTextNode(n)},setTextContent:function(n,e){e.textContent=n},createElement:function(n,e,t){return null!=n?t.createElementNS(n,e):t.createElement(e)},insertChildIx:function(n,e,t){var r=t.childNodes.item(n)||null;r!==e&&t.insertBefore(e,r)},removeChild:function(n,e){e&&n.parentNode===e&&e.removeChild(n)},parentNode:function(n){return n.parentNode},setAttribute:function(n,e,t,r){null!=n?r.setAttributeNS(n,e,t):r.setAttribute(e,t)},removeAttribute:function(n,e,t){null!=n?t.removeAttributeNS(n,e):t.removeAttribute(e)},hasAttribute:function(n,e,t){return null!=n?t.hasAttributeNS(n,e):t.hasAttribute(e)},addEventListener:function(n,e,t){t.addEventListener(n,e,!1)},removeEventListener:function(n,e,t){t.removeEventListener(n,e,!1)},jsUndefined:undefined};var Ff;Ff={eventListener:function(n){return function(){return function(e){return n(e)()}}},addEventListener:function(n){return function(e){return function(t){return function(r){return function(){return r.addEventListener(n,e,t)}}}}},removeEventListener:function(n){return function(e){return function(t){return function(r){return function(){return r.removeEventListener(n,e,t)}}}}}};var If=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Pf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Cf=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Nf=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Lf=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),qf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Rf=Tf.unsafeGetAny,Bf=Tf.unsafeSetAny,_f=function(n){if(n instanceof Cf&&n.value0 instanceof Q.Just)return"attr/"+n.value0.value0+":"+n.value1;if(n instanceof Cf)return"attr/:"+n.value1;if(n instanceof Nf)return"prop/"+n.value0;if(n instanceof Lf)return"handler/"+n.value0;if(n instanceof qf)return"ref";throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 182, column 16 - line 187, column 16): "+[n.constructor.name])};mf={Attribute:Cf,Property:Nf,Handler:Lf,Ref:qf,Created:If,Removed:Pf,propFromString:ze.unsafeCoerce,buildProp:function(n){return function(e){var t=function(n){return function(t,r){if(r instanceof Cf)return Tf.removeAttribute(wf.toNullable(r.value0),r.value1,e);if(r instanceof Nf)return function(n,e){return Tf.hasAttribute(wf.null,n,e)?Tf.removeAttribute(wf.null,n,e):"string"===bf.typeOf(Tf.unsafeGetAny(n,e))?Tf.unsafeSetAny(n,"",e):"rowSpan"===n||"colSpan"===n?Tf.unsafeSetAny(n,1,e):Tf.unsafeSetAny(n,Tf.jsUndefined,e)}(r.value0,e);if(r instanceof Lf){var u=Tf.unsafeLookup(r.value0,n);return Tf.removeEventListener(r.value0,oe.fst(u),e)}if(r instanceof qf)return W.unit;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 169, column 5 - line 179, column 18): "+[r.constructor.name])}},r=function(e){return e instanceof Q.Just?n(e.value0)():W.unit},u=function(n){var t=Yc.lookup("ref")(n.props);return t instanceof Q.Just&&t.value0 instanceof qf?r(t.value0.value0(new Pf(e))):W.unit},i=function(n){return function(t,u,i){if(i instanceof Cf)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.setAttribute(wf.toNullable(i.value0),i.value1,i.value2,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))();if(i instanceof Nf)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Bf(i.value0,i.value1,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))();if(i instanceof Lf){var a=Tf.unsafeGetAny(i.value0,n);if(Tf.unsafeHasAny(i.value0,n))return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(i.value1)(oe.snd(a)))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))();var o=Wo.new(i.value1)(),c=Ff.eventListener((function(n){return function(){var e=Wo.read(o)();return r(e(n))}}))();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.pokeMutMap(i.value0,new oe.Tuple(c,o),n)}))((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.addEventListener(i.value0,c,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))}))()}if(i instanceof qf)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return r(i.value0(new If(e)))}))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))();throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 113, column 5 - line 135, column 15): "+[i.constructor.name])}},a=function(n,r){var o=Tf.newMutMap(),c=t(n.events),f=function(n,t){return function(r,u,i,a){if(i instanceof Cf&&a instanceof Cf)return i.value2===a.value2?a:Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.setAttribute(wf.toNullable(a.value0),a.value1,a.value2,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(a)}))();if(i instanceof Nf&&a instanceof Nf){if(Tf.refEq(i.value1,a.value1))return a;if("value"===a.value0){var o=Rf("value",e);return Tf.refEq(o,a.value1)?a:Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Bf(a.value0,a.value1,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(a)}))()}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Bf(a.value0,a.value1,e)}))((function(n){return tn.pure(Ro.applicativeEffect)(a)}))()}if(i instanceof Lf&&a instanceof Lf){var c=Tf.unsafeLookup(a.value0,n);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(a.value1)(oe.snd(c)))((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.pokeMutMap(a.value0,c,t)}))((function(n){return tn.pure(Ro.applicativeEffect)(a)}))}))()}return a}}(n.events,o),l=i(o),v=Tf.diffWithKeyAndIxE(n.props,r,_f,f,c,l),s={events:Tf.unsafeFreeze(o),props:v};return yf.mkStep(new yf.Step(W.unit,s,a,u))};return function(n){var e=Tf.newMutMap(),t=Tf.strMapWithIxE(n,_f,i(e)),r={events:Tf.unsafeFreeze(e),props:t};return yf.mkStep(new yf.Step(W.unit,r,a,u))}}}};var Jf,Df={};Jf={bimap:function(n){return n.bimap},Bifunctor:function(n){this.bimap=n}};var Of=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Uf=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),xf=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Hf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Qf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Wf=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Gf=function(n){return function(e){return n(e)}},zf=ze.unsafeCoerce,Kf=new Jf.Bifunctor((function(n){return function(e){return Gf((function(t){return zf(new Wf((function(e){return n(t.value0(e))}),(function(n){return e(t.value1(n))}),t.value2))}))}})),Vf=Gf((function(n){var e=function(t){if(t instanceof Of)return new Of(t.value0);if(t instanceof Uf)return new Uf(t.value0,t.value1,n.value0(t.value2),x.map(x.functorArray)(e)(t.value3));if(t instanceof xf)return new xf(t.value0,t.value1,n.value0(t.value2),x.map(x.functorArray)(x.map(oe.functorTuple)(e))(t.value3));if(t instanceof Hf)return new Hf(n.value1(t.value0));if(t instanceof Qf)return new Qf(Jf.bimap(Kf)(n.value0)(n.value1)(t.value0));throw new Error("Failed pattern match at Halogen.VDom.Types (line 86, column 7 - line 86, column 27): "+[t.constructor.name])};return e(n.value2)}));Df={Text:Of,Elem:Uf,Keyed:xf,Widget:Hf,Grafted:Qf,Graft:Wf,graft:zf,unGraft:Gf,runGraft:Vf,ElemName:function(n){return n},Namespace:function(n){return n},bifunctorGraft:Kf};var jf=function(n){this.toPropValue=n},Xf=function(n){return n},Yf=function(n){return n.toPropValue},Zf=new jf(mf.propFromString),$f=mf.Handler.create,nl=function(n){return pf.prop(n)},el=nl((pf={HTML:Xf,text:function(n){return Df.Text.create(n)},element:function(n){return function(e){return function(t){return function(r){return new Df.Elem(n,e,t,r)}}}},prop:function(n){return function(e){var t=mf.Property.create(e),r=Yf(n);return function(n){return t(r(n))}}},attr:function(n){return function(e){return mf.Attribute.create(n)(e)}},handler:$f,IsProp:jf,toPropValue:Yf,isPropString:Zf}).isPropString)("src"),tl=pf.attr(Q.Nothing.value);df={prop:nl,attr:tl,src:el};var rl,ul,il,al,ol,cl,fl=(rl=Kc.joinWith("; "),ul=Yc.foldMap(Re.monoidArray)((function(n){return function(e){return[n+": "+e]}})),il=function(n){return rl(ul(n))},al=it.concatMap(at.foldMap(at.foldableEither)(Re.monoidArray)(it.singleton)),ol=function(n){return n instanceof Pe.Property?new Q.Just(new oe.Tuple(n.value0,n.value1)):Q.Nothing.value},cl=df.attr("style"),function(n){return cl(il((e=Pe.runS(n),t=Mn.bind(Mn.bindArray)(it.mapMaybe(ol)(e))((function(n){return al(Wc.collect(n))})),Yc.fromFoldable(at.foldableArray)(t))));var e,t});Gc={style:fl};var ll={},vl=pf.element(Q.Nothing.value),sl=vl("form"),dl=vl("h1"),pl=dl([]),ml=vl("table"),wl=vl("td"),hl=vl("tr"),bl=vl("div");ll={element:vl,div:bl,form:sl,h1:dl,h1_:pl,img:function(n){return vl("img")(n)([])},table:ml,td:wl,tr:hl};var yl={},gl={},El=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Al=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}();gl={RefLabel:function(n){return n},RefUpdate:El,Action:Al};var Sl,Ml=ze.unsafeCoerce,kl=function(n){return function(e){return pf.handler(n)((function(n){return new Q.Just(new gl.Action(e(n)))}))}},Tl=(Sl=kl({click:"click"}.click),function(n){return Sl(Ml(n))});yl={handler:kl,onClick:Tl};var Fl,Il=function(n){return function(n){return function(e){return function(t){return function(r){var u=t(oe.fst(e)),i=Br.lookup(n)(u)(r);return Q.maybe(Br.insert(n)(u)([oe.snd(e)])(r))((function(t){return Br.insert(n)(u)(it.cons(oe.snd(e))(t))(r)}))(i)}}}}},Pl=function(n){return it.zip(it.fromFoldable(br.foldableList)(Br.keys(n)))(it.fromFoldable(br.foldableList)(Br.values(n)))};Fl={groupByKeys:function(n){return function(n){return function(e){return function(t){var r=Pl(t);return it.foldl((function(t){return function(r){return Il()(n)(r)(e)(t)}}))(Br.empty)(r)}}}},updateResult:Il,toArray:Pl};var Cl=function(){function n(){}return n.value=new n,n}(),Nl=function(){function n(){}return n.value=new n,n}(),Ll=function(){function n(){}return n.value=new n,n}(),ql=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Rl=function(){function n(){}return n.value=new n,n}(),Bl=function(n){if(n instanceof Cl)return Gc.style(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(fr.height(Kt.px(a.toNumber(50))))(fr.width(Kt.px(a.toNumber(50)))))(r.backgroundColor(u.rgb(245)(245)(245))))(rr.display(rr.inlineBlock)));if(n instanceof Nl)return Gc.style(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(fr.height(Kt.px(a.toNumber(50))))(fr.width(Kt.px(a.toNumber(50)))))(r.backgroundColor(u.rgb(32)(32)(32))))(rr.display(rr.inlineBlock)));if(n instanceof Ll)return Gc.style(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(fr.height(Kt.px(a.toNumber(50))))(fr.width(Kt.px(a.toNumber(50)))))(r.backgroundColor(u.rgb(0)(127)(255))))(rr.display(rr.inlineBlock)));throw new Error("Failed pattern match at BoardComponent (line 130, column 10 - line 133, column 156): "+[n.constructor.name])},_l=Gc.style(rn.applySecond(Pe.applyStyleM)(fr.width(Kt.pct(a.toNumber(85))))(rr.display(rr.block))),Jl=function(n){return{game:ei.makeGame,selectedPosition:Q.Nothing.value}},Dl=function(n){if(n.pieceType instanceof fu.Pawn&&n.color instanceof fu.WhitePiece)return"whitePawn.png";if(n.pieceType instanceof fu.Bishop&&n.color instanceof fu.WhitePiece)return"whiteBishop.png";if(n.pieceType instanceof fu.Knight&&n.color instanceof fu.WhitePiece)return"whiteKnight.png";if(n.pieceType instanceof fu.Rook&&n.color instanceof fu.WhitePiece)return"whiteRook.png";if(n.pieceType instanceof fu.Queen&&n.color instanceof fu.WhitePiece)return"whiteQueen.png";if(n.pieceType instanceof fu.King&&n.color instanceof fu.WhitePiece)return"whiteKing.png";if(n.pieceType instanceof fu.Pawn&&n.color instanceof fu.BlackPiece)return"blackPawn.png";if(n.pieceType instanceof fu.Bishop&&n.color instanceof fu.BlackPiece)return"blackBishop.png";if(n.pieceType instanceof fu.Knight&&n.color instanceof fu.BlackPiece)return"blackKnight.png";if(n.pieceType instanceof fu.Rook&&n.color instanceof fu.BlackPiece)return"blackRook.png";if(n.pieceType instanceof fu.Queen&&n.color instanceof fu.BlackPiece)return"blackQueen.png";if(n.pieceType instanceof fu.King&&n.color instanceof fu.BlackPiece)return"blackKing.png";throw new Error("Failed pattern match at BoardComponent (line 115, column 13 - line 127, column 61): "+[n.constructor.name])},Ol=function(n){return df.src("pieces/"+Dl({pieceType:n.pieceType,color:n.color}))},Ul=function(n){return Q.maybe(pf.text(""))(an.identity(an.categoryFn))(x.map(Q.functorMaybe)((function(n){return ll.img([Ol(n),_l])}))(n.currentPiece))},xl=function(n){return function(e){return function(t){var r=function(){if(t instanceof ei.WhiteTurn)return Q.maybe(!1)((function(n){return m.eq(fu.eqPieceColor)(n.color)(fu.WhitePiece.value)}))(n.currentPiece);if(t instanceof ei.BlackTurn)return Q.maybe(!1)((function(n){return m.eq(fu.eqPieceColor)(n.color)(fu.BlackPiece.value)}))(n.currentPiece);throw new Error("Failed pattern match at BoardComponent (line 92, column 21 - line 94, column 93): "+[t.constructor.name])}(),u=fu.tileColor(We.wrap()(n)),i=function(){if(Q.maybe(!1)(m.eq(fu.eqPosition)(n.position))(e)&&r)return iu.trace()(Nn.show(Q.showMaybe(fu.showPosition))(e))((function(n){return Ll.value}));if(u instanceof fu.WhiteTile)return Cl.value;if(u instanceof fu.BlackTile)return Nl.value;throw new Error("Failed pattern match at BoardComponent (line 97, column 31 - line 99, column 51): "+[u.constructor.name])}();return ll.td([Bl(i),yl.onClick((function(e){return new ql(n.position)}))])([Ul(We.wrap()(n))])}}},Hl=function(n){return function(e){return function(t){return ll.tr([Gc.style(jt.borderSpacing(Kt.nil))])(x.map(x.functorArray)((function(n){return xl(n)(e)(t)}))(it.sort(fu.ordTile)(n)))}}},Ql=function(n){var e=Fl.groupByKeys(fu.ordPosition)(fu.ordRank)((function(n){return n.rank}))(n.game.currentBoard.tiles),t=hr.reverse(hr.sort(fu.ordRank)(Br.keys(e)));return ll.form([Gc.style(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(rr.display(rr.block))(fr.marginLeft(Vt.auto(Kt.autoSize))))(fr.marginRight(Vt.auto(Kt.autoSize))))])([ll.div([Gc.style(rr.display(rr.block))])([ll.h1_([pf.text("aaa")]),ll.table([Gc.style(rn.applySecond(Pe.applyStyleM)(rn.applySecond(Pe.applyStyleM)(jt.borderSpacing(Kt.nil))(fr.marginLeft(Vt.auto(Kt.autoSize))))(fr.marginRight(Vt.auto(Kt.autoSize))))])(x.map(x.functorArray)((function(t){return u=t,r=Q.maybe([])(an.identity(an.categoryFn))(Br.lookup(fu.ordRank)(u)(e)),Hl(r)(n.selectedPosition)(n.game.turn);var r,u}))(it.fromFoldable(br.foldableList)(t)))])])},Wl=function(n){return function(e){if(e instanceof ql)return Mn.bind(Lo.bindHalogenM)(pr.get(Lo.monadStateHalogenM))((function(t){var r=function(){if(t.selectedPosition instanceof Q.Nothing){var n={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.selectedPosition=new Q.Just(e.value0),n}if(t.selectedPosition instanceof Q.Just){if(m.eq(fu.eqPosition)(t.selectedPosition.value0)(e.value0)){var u={};for(var i in t)({}).hasOwnProperty.call(t,i)&&(u[i]=t[i]);return u.selectedPosition=Q.Nothing.value,u}var a=ei.move(t.selectedPosition.value0)(e.value0)(t.game);return Q.maybe(function(){var n={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.selectedPosition=new Q.Just(e.value0),n}())((function(n){var e={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.game=n,e.selectedPosition=Q.Nothing.value,e}))(a)}throw new Error("Failed pattern match at BoardComponent (line 140, column 28 - line 147, column 134): "+[t.selectedPosition.constructor.name])}();return Mn.discard(Mn.discardUnit)(Lo.bindHalogenM)(pr.put(Lo.monadStateHalogenM)(r))((function(e){return Wl(n)(Rl.value)}))}));if(e instanceof Rl)return pr.modify_(Lo.monadStateHalogenM)((function(n){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.game=ei.updateCheckOrMate(n.game),e}));throw new Error("Failed pattern match at BoardComponent (line 136, column 16 - line 151, column 75): "+[e.constructor.name])}};n={Click:ql,IsCheckOrMate:Rl,component:function(n){return Mo.mkComponent({initialState:Jl,render:Ql,eval:Mo.mkEval({handleAction:Wl(n),handleQuery:Mo.defaultEval.handleQuery,receive:Mo.defaultEval.receive,initialize:Mo.defaultEval.initialize,finalize:Mo.defaultEval.finalize})})},initialState:Jl,render:Ql,renderRank:Hl,renderTile:xl,White:Cl,Black:Nl,Selected:Ll,maybeImage:Ul,pieceImage:Ol,pieceStyle:_l,imageName:Dl,square:Bl,handleAction:Wl};var Gl,zl,Kl,Vl,jl,Xl,Yl,Zl,$l,nv,ev,tv,rv,uv={},iv=function(){var n={},e="Pure",t="Throw",r="Catch",u="Sync",i="Async",a="Bind",o="Bracket",c="Fork",f="Sequential",l="Map",v="Apply",s="Alt",d="Cons",p="Resume",m="Release",w="Finalizer",h="Finalized",b="Forked";function y(n,e,t,r){this.tag=n,this._1=e,this._2=t,this._3=r}function g(n){var e=function(e,t,r){return new y(n,e,t,r)};return e.tag=n,e}function E(n){return new y(e,void 0)}function A(n){try{n()}catch(n){setTimeout((function(){throw n}),0)}}function S(n,e,t){try{return e(t())}catch(e){return n(e)}}function M(n,e,t){try{return e(t)()}catch(e){return t(n(e))(),E}}var k=function(){var n=1024,e=0,t=0,r=new Array(n),u=!1;function i(){var i;for(u=!0;0!==e;)e--,i=r[t],r[t]=void 0,t=(t+1)%n,i();u=!1}return{isDraining:function(){return u},enqueue:function(a){var o;e===n&&(o=u,i(),u=o),r[(t+e)%n]=a,e++,u||i()}}}();function T(n,l,v){var s=0,b=0,g=v,E=null,F=null,P=null,C=null,N=null,L=0,q=0,R=null,B=!0;function _(v){for(var q,J,D;;)switch(q=null,J=null,D=null,b){case 2:b=1;try{g=P(g),null===C?P=null:(P=C._1,C=C._2)}catch(e){b=5,E=n.left(e),g=null}break;case 3:n.isLeft(g)?(b=5,E=g,g=null):null===P?b=5:(b=2,g=n.fromRight(g));break;case 1:switch(g.tag){case a:P&&(C=new y(d,P,C)),P=g._2,b=1,g=g._1;break;case e:null===P?(b=5,g=n.right(g._1)):(b=2,g=g._1);break;case u:b=3,g=S(n.left,n.right,g._1);break;case i:return b=4,void(g=M(n.left,g._1,(function(n){return function(){s===v&&(s++,k.enqueue((function(){s===v+1&&(b=3,g=n,_(s))})))}})));case t:b=5,E=n.left(g._1),g=null;break;case r:N=new y(d,g,null===P?N:new y(d,new y(p,P,C),N,F),F),P=null,C=null,b=1,g=g._1;break;case o:L++,N=new y(d,g,null===P?N:new y(d,new y(p,P,C),N,F),F),P=null,C=null,b=1,g=g._1;break;case c:b=3,q=T(n,l,g._2),l&&l.register(q),g._1&&q.run(),g=n.right(q);break;case f:b=1,g=I(n,l,g._1)}break;case 5:if(P=null,C=null,null===N)b=6,g=F||E||g;else switch(q=N._3,D=N._1,N=N._2,D.tag){case r:F&&F!==q&&0===L?b=5:E&&(b=1,g=D._2(n.fromLeft(E)),E=null);break;case p:F&&F!==q&&0===L||E?b=5:(P=D._1,C=D._2,b=2,g=n.fromRight(g));break;case o:L--,null===E&&(J=n.fromRight(g),N=new y(d,new y(m,D._2,J),N,q),(F===q||L>0)&&(b=1,g=D._3(J)));break;case m:N=new y(d,new y(h,g,E),N,F),b=1,g=F&&F!==q&&0===L?D._1.killed(n.fromLeft(F))(D._2):E?D._1.failed(n.fromLeft(E))(D._2):D._1.completed(n.fromRight(g))(D._2),E=null,L++;break;case w:L++,N=new y(d,new y(h,g,E),N,F),b=1,g=D._1;break;case h:L--,b=5,g=D._1,E=D._2}break;case 6:for(var O in R)R.hasOwnProperty(O)&&(B=B&&R[O].rethrow,A(R[O].handler(g)));return R=null,void(F&&E?setTimeout((function(){throw n.fromLeft(E)}),0):n.isLeft(g)&&B&&setTimeout((function(){if(B)throw n.fromLeft(g)}),0));case 0:b=1;break;case 4:return}}function J(n){return function(){if(6===b)return B=B&&n.rethrow,n.handler(g)(),function(){};var e=q++;return(R=R||{})[e]=n,function(){null!==R&&delete R[e]}}}return{kill:function(e,t){return function(){if(6===b)return t(n.right(void 0))(),function(){};var r=J({rethrow:!1,handler:function(){return t(n.right(void 0))}})();switch(b){case 0:F=n.left(e),b=6,g=F,_(s);break;case 4:null===F&&(F=n.left(e)),0===L&&(4===b&&(N=new y(d,new y(w,g(e)),N,F)),b=5,g=null,E=null,_(++s));break;default:null===F&&(F=n.left(e)),0===L&&(b=5,g=null,E=null)}return r}},join:function(n){return function(){var e=J({rethrow:!1,handler:n})();return 0===b&&_(s),e}},onComplete:J,isSuspended:function(){return 0===b},run:function(){0===b&&(k.isDraining()?_(s):k.enqueue((function(){_(s)})))}}}function F(e,t,r,u){var a=0,o={},c=0,f={},p=new Error("[ParAff] Early exit"),m=null,w=n;function h(t,r,u){var i,a,c=r,f=null,p=null,m=0,w={};n:for(;;)switch(i=null,c.tag){case b:if(c._3===n&&(i=o[c._1],w[m++]=i.kill(t,(function(n){return function(){0===--m&&u(n)()}}))),null===f)break n;c=f._2,null===p?f=null:(f=p._1,p=p._2);break;case l:c=c._2;break;case v:case s:f&&(p=new y(d,f,p)),f=c,c=c._1}if(0===m)u(e.right(void 0))();else for(a=0,i=m;a<i;a++)w[a]=w[a]();return w}function g(t,r,i){var a,o,d,w,b,y;for(e.isLeft(t)?(a=t,o=null):(o=t,a=null);;){if(d=null,w=null,b=null,y=null,null!==m)return;if(null===r)return void u(a||o)();if(r._3!==n)return;switch(r.tag){case l:null===a?(r._3=e.right(r._1(e.fromRight(o))),o=r._3):r._3=a;break;case v:if(d=r._1._3,w=r._2._3,a){if(r._3=a,b=!0,y=c++,f[y]=h(p,a===d?r._2:r._1,(function(){return function(){delete f[y],b?b=!1:null===i?g(a,null,null):g(a,i._1,i._2)}})),b)return void(b=!1)}else{if(d===n||w===n)return;o=e.right(e.fromRight(d)(e.fromRight(w))),r._3=o}break;case s:if(d=r._1._3,w=r._2._3,d===n&&e.isLeft(w)||w===n&&e.isLeft(d))return;if(d!==n&&e.isLeft(d)&&w!==n&&e.isLeft(w))a=o===d?w:d,o=null,r._3=a;else if(r._3=o,b=!0,y=c++,f[y]=h(p,o===d?r._2:r._1,(function(){return function(){delete f[y],b?b=!1:null===i?g(o,null,null):g(o,i._1,i._2)}})),b)return void(b=!1)}null===i?r=null:(r=i._1,i=i._2)}}function A(n){return function(e){return function(){delete o[n._1],n._3=e,g(e,n._2._1,n._2._2)}}}return function(){var u,i,c=1,f=r,p=null,m=null;n:for(;;)switch(u=null,i=null,c){case 1:switch(f.tag){case l:p&&(m=new y(d,p,m)),p=new y(l,f._1,n,n),f=f._2;break;case v:p&&(m=new y(d,p,m)),p=new y(v,n,f._2,n),f=f._1;break;case s:p&&(m=new y(d,p,m)),p=new y(s,n,f._2,n),f=f._1;break;default:i=a++,c=5,u=f,f=new y(b,i,new y(d,p,m),n),(u=T(e,t,u)).onComplete({rethrow:!1,handler:A(f)})(),o[i]=u,t&&t.register(u)}break;case 5:if(null===p)break n;p._1===n?(p._1=f,c=1,f=p._2,p._2=n):(p._2=f,f=p,null===m?p=null:(p=m._1,m=m._2))}for(w=f,i=0;i<a;i++)o[i].run()}(),function(n){return new y(i,(function(t){return function(){return function(n,t){var r;for(var u in m=e.left(n),f)if(f.hasOwnProperty(u))for(u in r=f[u])r.hasOwnProperty(u)&&r[u]();f=null;var a=h(n,w,t);return function(n){return new y(i,(function(n){return function(){for(var n in a)a.hasOwnProperty(n)&&a[n]();return E}}))}}(n,t)}}))}}function I(n,e,t){return new y(i,(function(r){return function(){return F(n,e,t,r)}}))}return y.EMPTY=n,y.Pure=g(e),y.Throw=g(t),y.Catch=g(r),y.Sync=g(u),y.Async=g(i),y.Bind=g(a),y.Bracket=g(o),y.Fork=g(c),y.Seq=g(f),y.ParMap=g(l),y.ParApply=g(v),y.ParAlt=g(s),y.Fiber=T,y.Supervisor=function(n){var e={},t=0,r=0;return{register:function(n){var u=t++;n.onComplete({rethrow:!0,handler:function(n){return function(){r--,delete e[u]}}})(),e[u]=n,r++},isEmpty:function(){return 0===r},killAll:function(i,a){return function(){if(0===r)return a();var o=0,c={};function f(t){c[t]=e[t].kill(i,(function(e){return function(){delete c[t],o--,n.isLeft(e)&&n.fromLeft(e)&&setTimeout((function(){throw n.fromLeft(e)}),0),0===o&&a()}}))()}for(var l in e)e.hasOwnProperty(l)&&(o++,f(l));return e={},t=0,r=0,function(n){return new y(u,(function(){for(var n in c)c.hasOwnProperty(n)&&c[n]()}))}}}}},y.Scheduler=k,y.nonCanceler=E,y}();Gl=iv.Pure,zl=iv.Throw,Kl=function(n){return function(e){return iv.Catch(n,e)}},Vl=function(n){return function(e){return e.tag===iv.Pure.tag?iv.Pure(n(e._1)):iv.Bind(e,(function(e){return iv.Pure(n(e))}))}},jl=function(n){return function(e){return iv.Bind(n,e)}},Xl=function(n){return function(e){return iv.Fork(n,e)}},Yl=iv.Sync,Zl=function(n){return function(e){return iv.ParMap(n,e)}},$l=function(n){return function(e){return iv.ParApply(n,e)}},nv=iv.Async,ev=function(n){return function(e){return function(t){return iv.Bracket(n,e,t)}}},tv=function(n,e){return function(){return iv.Fiber(n,null,e)}},rv=iv.Seq;var av,ov=function(n){return n.catchError};av={catchError:ov,throwError:function(n){return n.throwError},MonadThrow:function(n,e){this.Monad0=n,this.throwError=e},MonadError:function(n,e){this.MonadThrow0=n,this.catchError=e},try:function(n){return function(e){return ov(n)(x.map(n.MonadThrow0().Monad0().Bind1().Apply0().Functor0())(ft.Right.create)(e))((t=tn.pure(n.MonadThrow0().Monad0().Applicative0()),function(n){return t(ft.Left.create(n))}));var t}}};var cv;cv={parallel:function(n){return n.parallel},sequential:function(n){return n.sequential},Parallel:function(n,e,t,r){this.Applicative1=n,this.Monad0=e,this.parallel=t,this.sequential=r}};var fv,lv=function(n,e){this.Monad0=n,this.liftEffect=e},vv=new lv((function(n){return Ro.monadEffect}),an.identity(an.categoryFn));fv={liftEffect:function(n){return n.liftEffect},MonadEffect:lv,monadEffectEffect:vv};var sv,dv,pv;pv=function(n){throw new Error(n)};dv={crashWith:function(n){return pv}};var mv=function(n){return n()};sv={unsafePartial:mv,unsafeCrashWith:function(n){return mv((function(e){return dv.crashWith()(n)}))}};var wv,hv,bv,yv=function(n){return n},gv=Xl(!1),Ev=new x.Functor(Zl),Av=new x.Functor(Vl),Sv=Xl(!0),Mv={isLeft:function(n){if(n instanceof ft.Left)return!0;if(n instanceof ft.Right)return!1;throw new Error("Failed pattern match at Effect.Aff (line 394, column 12 - line 396, column 20): "+[n.constructor.name])},fromLeft:function(n){if(n instanceof ft.Left)return n.value0;if(n instanceof ft.Right)return sv.unsafeCrashWith("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 399, column 20 - line 401, column 54): "+[n.constructor.name])},fromRight:function(n){if(n instanceof ft.Right)return n.value0;if(n instanceof ft.Left)return sv.unsafeCrashWith("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 404, column 21 - line 406, column 54): "+[n.constructor.name])},left:ft.Left.create,right:ft.Right.create},kv=function(n){return tv(Mv,n)},Tv=function(n){return function(){var e=kv(n)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(e.run)((function(n){return tn.pure(Ro.applicativeEffect)(e)}))()}},Fv=function(n){return function(e){return ev(n)({killed:H.const(e),failed:H.const(e),completed:H.const(e)})}},Iv=new rn.Apply((function(n){return Ev}),$l),Pv=new Le.Monad((function(n){return Lv}),(function(n){return Cv})),Cv=new Mn.Bind((function(n){return Nv}),jl),Nv=new rn.Apply((function(n){return Av}),Le.ap(Pv)),Lv=new tn.Applicative((function(n){return Nv}),Gl),qv=new fv.MonadEffect((function(n){return Pv}),Yl),Rv=(wv=fv.liftEffect(qv),function(n){return H.const(wv(n))}),Bv=function(n){return nv((function(e){return x.map(Ro.functorEffect)(Rv)(n.join(e))}))},_v=new x.Functor((function(n){return function(e){return $u.unsafePerformEffect(kv(x.map(Av)(n)(Bv(e))))}})),Jv=new av.MonadThrow((function(n){return Pv}),zl),Dv=new av.MonadError((function(n){return Jv}),Kl),Ov=function(n){return function(e){return Tv(Mn.bindFlipped(Cv)((t=fv.liftEffect(qv),function(e){return t(n(e))}))(av.try(Dv)(e)));var t}},Uv=new cv.Parallel((function(n){return xv}),(function(n){return Pv}),ze.unsafeCoerce,rv),xv=new tn.Applicative((function(n){return Iv}),(hv=cv.parallel(Uv),bv=tn.pure(Lv),function(n){return hv(bv(n))})),Hv=new Do.MonadRec((function(n){return Pv}),(function(n){var e=function(t){return Mn.bind(Cv)(n(t))((function(n){if(n instanceof Do.Done)return tn.pure(Lv)(n.value0);if(n instanceof Do.Loop)return e(n.value0);throw new Error("Failed pattern match at Effect.Aff (line 102, column 7 - line 104, column 22): "+[n.constructor.name])}))};return e})),Qv=H.const(tn.pure(Lv)(W.unit));uv={Canceler:yv,launchAff:Tv,runAff:Ov,runAff_:function(n){return function(e){return x.void(Ro.functorEffect)(Ov(n)(e))}},forkAff:Sv,suspendAff:gv,finally:function(n){return function(e){return Fv(tn.pure(Lv)(W.unit))(H.const(n))(H.const(e))}},killFiber:function(n){return function(e){return Mn.bind(Cv)(fv.liftEffect(qv)(e.isSuspended))((function(t){return t?fv.liftEffect(qv)(x.void(Ro.functorEffect)(e.kill(n,H.const(tn.pure(Ro.applicativeEffect)(W.unit))))):nv((function(t){return x.map(Ro.functorEffect)(Rv)(e.kill(n,t))}))}))}},joinFiber:Bv,bracket:Fv,nonCanceler:Qv,effectCanceler:Rv,functorAff:Av,applyAff:Nv,applicativeAff:Lv,bindAff:Cv,monadAff:Pv,monadRecAff:Hv,monadThrowAff:Jv,monadErrorAff:Dv,monadEffectAff:qv,functorParAff:Ev,applyParAff:Iv,applicativeParAff:xv,parallelAff:Uv,functorFiber:_v,makeAff:nv,generalBracket:ev};var Wv,Gv=function(n,e){this.MonadEffect0=n,this.liftAff=e},zv=new Gv((function(n){return uv.monadEffectAff}),an.identity(an.categoryFn));Wv={MonadAff:Gv,monadAffAff:zv};var Kv,Vv,jv={};Vv=function(n){return function(e){return function(){return e.querySelector(n)}}};Kv={QuerySelector:function(n){return n},querySelector:function(n){var e=x.map(Ro.functorEffect)(wf.toMaybe),t=Vv(n);return function(n){return e(t(n))}}};var Xv;Xv={window:function(){return window}};var Yv;Yv={domcontentloaded:"DOMContentLoaded"};var Zv,$v={};Zv=function(n){return function(){return n.readyState}};var ns,es=function(){function n(){}return n.value=new n,n}(),ts=function(){function n(){}return n.value=new n,n}(),rs=function(){function n(){}return n.value=new n,n}();ns={Loading:es,Interactive:ts,Complete:rs,parse:function(n){return"loading"===n?new Q.Just(es.value):"interactive"===n?new Q.Just(ts.value):"complete"===n?new Q.Just(rs.value):Q.Nothing.value}};var us,is,as=ze.unsafeCoerce,os=ze.unsafeCoerce,cs=(is=x.map(Ro.functorEffect)((us=Q.fromMaybe(ns.Loading.value),function(n){return us(ns.parse(n))})),function(n){return is(Zv(n))});$v={toDocument:os,toParentNode:as,readyState:cs};var fs,ls={};fs=function(n,e,t){var r=Object.prototype.toString.call(t);return 0===r.indexOf("[object HTML")&&r.indexOf("Element]")===r.length-8?e(t):n};ls={fromElement:function(n){return fs(Q.Nothing.value,Q.Just.create,n)},toNode:ze.unsafeCoerce};var vs;vs={toEventTarget:ze.unsafeCoerce,document:function(n){return function(){return n.document}}};var ss=function(n){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Mn.bindFlipped(Ro.bindEffect)(Mn.composeKleisliFlipped(Ro.bindEffect)((e=Kv.querySelector(n),function(n){return e($v.toParentNode(n))}))(vs.document))(Xv.window)))((function(n){return tn.pure(uv.applicativeAff)(Mn.bindFlipped(Q.bindMaybe)(ls.fromElement)(n))}));var e},ds=uv.runAff_(ft.either(Xu.throwException)(H.const(tn.pure(Ro.applicativeEffect)(W.unit)))),ps=uv.makeAff((function(n){return function(){if(Mn.bindFlipped(Ro.bindEffect)($v.readyState)(Mn.bindFlipped(Ro.bindEffect)(vs.document)(Xv.window))()instanceof ns.Loading){var e=x.map(Ro.functorEffect)(vs.toEventTarget)(Xv.window)(),t=Ff.eventListener((function(e){return n(new ft.Right(W.unit))}))();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Ff.addEventListener(Yv.domcontentloaded)(t)(!1)(e))((function(n){return tn.pure(Ro.applicativeEffect)(uv.effectCanceler(Ff.removeEventListener(Yv.domcontentloaded)(t)(!1)(e)))}))()}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(n(new ft.Right(W.unit)))((function(n){return tn.pure(Ro.applicativeEffect)(uv.nonCanceler)}))()}}));jv={awaitLoad:ps,awaitBody:Mn.discard(Mn.discardUnit)(uv.bindAff)(ps)((function(n){return Mn.bind(uv.bindAff)(ss("body"))((function(n){return Q.maybe(av.throwError(uv.monadThrowAff)(Xu.error("Could not find body")))(tn.pure(uv.applicativeAff))(n)}))})),selectElement:ss,runHalogenAff:ds};var ms,ws,hs=function(n,e,t,r,u,i){this.conj=n,this.disj=e,this.ff=t,this.implies=r,this.not=u,this.tt=i},bs=function(n){return n.tt},ys=function(n){return n.not},gs=function(n){return n.implies},Es=function(n){return n.ff},As=function(n){return n.disj},Ss=new hs((function(n){return function(e){return n&&e}}),(function(n){return function(e){return n||e}}),!1,(function(n){return function(e){return As(Ss)(ys(Ss)(n))(e)}}),(function(n){return!n}),!0),Ms=function(n){return n.conj};ws={HeytingAlgebra:hs,tt:bs,ff:Es,implies:gs,conj:Ms,disj:As,not:ys,heytingAlgebraBoolean:Ss,heytingAlgebraFunction:function(n){return new hs((function(e){return function(t){return function(r){return Ms(n)(e(r))(t(r))}}}),(function(e){return function(t){return function(r){return As(n)(e(r))(t(r))}}}),(function(e){return Es(n)}),(function(e){return function(t){return function(r){return gs(n)(e(r))(t(r))}}}),(function(e){return function(t){return ys(n)(e(t))}}),(function(e){return bs(n)}))}};var ks,Ts,Fs=function(n,e,t,r,u){this.Functor1=n,this.Monad0=e,this.fork=t,this.join=r,this.suspend=u},Is=new Fs((function(n){return uv.functorFiber}),(function(n){return uv.monadAff}),uv.forkAff,uv.joinFiber,uv.suspendAff);Ts={fork:function(n){return n.fork},MonadFork:Fs,monadForkAff:Is};var Ps,Cs=function(n){return function(e){return function(t){var r,u=cv.sequential(n),i=at.traverse_(n.Applicative1())(e)((r=cv.parallel(n),function(n){return r(t(n))}));return function(n){return u(i(n))}}}};Ps={parTraverse_:Cs,parSequence_:function(n){return function(e){return Cs(n)(e)(an.identity(an.categoryFn))}}};var Ns;Ns={warn:function(n){return function(){console.warn(n)}}};var Ls,qs,Rs={},Bs={},_s={},Js=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Ds=(qs=(_s={NonEmpty:Js,singleton:function(n){return function(e){return new Js(e,yn.empty(n))}}}).singleton(br.plusList),function(n){return br.NonEmptyList(qs(n))});Bs={singleton:Ds,cons:function(n){return function(e){return new _s.NonEmpty(n,new br.Cons(e.value0,e.value1))}}};var Os=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Us=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),xs=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Hs=function(n){return function(e){return new xs(n,e)}},Qs=Us.create,Ws=function(n){return function(e){return function(t){return function(r){var u,i=n,a=e,o=t,c=!1;function f(n,e,t,u){if(e instanceof br.Nil)return c=!0,new ft.Left(u);if(e instanceof br.Cons){var f=rn.apply(n.Apply0())(e.value0.func)(u);if(1===e.value0.count)return e.value1 instanceof br.Nil?(c=!0,new ft.Left(f)):(i=n,a=e.value1,o=t,void(r=f));if(t instanceof br.Nil)return c=!0,new ft.Left(f);if(t instanceof br.Cons)return c=!0,ft.Right.create(new oe.Tuple(new br.Cons({func:f,count:e.value0.count-1|0},e.value1),new _s.NonEmpty(t.value0,t.value1)));throw new Error("Failed pattern match at Control.Applicative.Free (line 83, column 11 - line 88, column 50): "+[t.constructor.name])}throw new Error("Failed pattern match at Control.Applicative.Free (line 72, column 3 - line 88, column 50): "+[e.constructor.name])}for(;!c;)u=f(i,a,o,r);return u}}}},Gs=new x.Functor((function(n){return function(e){return Hs(new Os(n))(e)}})),zs=function(n){return function(e){return function(t){return function(t){var r,u=!1;function i(r){if(r.value1.value0 instanceof Os){if((i=Ws(n)(r.value0)(r.value1.value1)(tn.pure(n)(r.value1.value0.value0)))instanceof ft.Left)return u=!0,i.value0;if(i instanceof ft.Right)return void(t=i.value0);throw new Error("Failed pattern match at Control.Applicative.Free (line 54, column 17 - line 56, column 24): "+[i.constructor.name])}if(r.value1.value0 instanceof Us){var i;if((i=Ws(n)(r.value0)(r.value1.value1)(e(r.value1.value0.value0)))instanceof ft.Left)return u=!0,i.value0;if(i instanceof ft.Right)return void(t=i.value0);throw new Error("Failed pattern match at Control.Applicative.Free (line 57, column 17 - line 59, column 24): "+[i.constructor.name])}var a;if(!(r.value1.value0 instanceof xs))throw new Error("Failed pattern match at Control.Applicative.Free (line 53, column 5 - line 62, column 47): "+[r.value1.value0.constructor.name]);var o=new _s.NonEmpty(r.value1.value0.value1,r.value1.value1);t=(a=n,function(n){return function(e){return function(t){return function(r){return function(u){var i,o=a,c=n,f=e,l=t,v=r,s=!1;function d(n,e,t,r,i,a){if(i instanceof Os)return s=!0,new oe.Tuple(new br.Cons({func:tn.pure(n)(i.value0),count:a},e),t);if(i instanceof Us)return s=!0,new oe.Tuple(new br.Cons({func:r(i.value0),count:a},e),t);if(i instanceof xs)return o=n,c=e,f=Bs.cons(i.value1)(t),l=r,v=i.value0,void(u=a+1|0);throw new Error("Failed pattern match at Control.Applicative.Free (line 102, column 41 - line 105, column 81): "+[i.constructor.name])}for(;!s;)i=d(o,c,f,l,v,u);return i}}}}})(r.value0)(o)(e)(r.value1.value0.value0)(1)}for(;!u;)r=i(t);return r}(new oe.Tuple(br.Nil.value,Bs.singleton(t)))}}},Ks=new rn.Apply((function(n){return Gs}),(function(n){return function(e){return Hs(n)(e)}})),Vs=new tn.Applicative((function(n){return Ks}),Os.create);Ls={liftFreeAp:Qs,retractFreeAp:function(n){return zs(n)(an.identity(an.categoryFn))},foldFreeAp:zs,hoistFreeAp:function(n){return zs(Vs)((function(e){return Qs(n(e))}))},functorFreeAp:Gs,applyFreeAp:Ks,applicativeFreeAp:Vs};var js,Xs={},Ys=Br.empty;js={empty:Ys,foreachSlot:function(n){return function(e){return function(t){return at.traverse_(n)(Br.foldableMap)((function(n){return t(n)}))(e)}}}};var Zs=ze.unsafeCoerce,$s=ze.unsafeCoerce,nd=ze.unsafeCoerce;Xs={DriverState:function(n){return n},mapDriverState:function(n){return function(e){return n(e)}},DriverStateRef:function(n){return n},unDriverStateX:Zs,mkDriverStateXRef:nd,renderStateX:function(n){return function(n){return Zs((function(e){return $s(n(e.rendering))}))}},renderStateX_:function(n){return function(e){return Zs((function(t){return at.traverse_(n)(at.foldableMaybe)(e)(t.rendering)}))}},unRenderStateX:ze.unsafeCoerce,initDriverState:function(n){return function(e){return function(t){return function(r){return function(){var u=Wo.new({})(),i=Wo.new(js.empty)(),a=Wo.new(js.empty)(),o=Wo.new(t)(),c=Wo.new(new Q.Just(br.Nil.value))(),f=Wo.new(new Q.Just(br.Nil.value))(),l=Wo.new(Q.Nothing.value)(),v=Wo.new(1)(),s=Wo.new(new Q.Just(Br.empty))(),d=Wo.new(Br.empty)(),p={component:n,state:n.initialState(e),refs:Br.empty,children:js.empty,childrenIn:i,childrenOut:a,selfRef:u,handlerRef:o,pendingQueries:c,pendingOuts:f,pendingHandlers:l,rendering:Q.Nothing.value,fresh:v,subscriptions:s,forks:d,lifecycleHandlers:r};return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(p)(u))((function(n){return tn.pure(Ro.applicativeEffect)(nd(u))}))()}}}}}};var ed={},td=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}();ed={ChildQuery:td,unChildQueryBox:ze.unsafeCoerce};var rd,ud,id={};id={unsafeRefEq:ud=function(n){return function(e){return n===e}},reallyUnsafeRefEq:ud};rd={create:function(){var n=Wo.new([])();return{emitter:function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.modify_((function(n){return V.append(V.semigroupArray)(n)([e])}))(n))((function(t){return tn.pure(Ro.applicativeEffect)(Wo.modify_(it.deleteBy(id.unsafeRefEq)(e))(n))}))},listener:function(e){return Mn.bind(Ro.bindEffect)(Wo.read(n))(at.traverse_(Ro.applicativeEffect)(at.foldableArray)((function(n){return n(e)})))}}},notify:function(n){return function(e){return n(e)}},subscribe:function(n){return function(e){return n((t=x.void(Ro.functorEffect),function(n){return t(e(n))}));var t}},unsubscribe:function(n){return n}};var ad=function(n){return function(e){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(n)))((function(t){if(t instanceof Q.Nothing)return e;if(t instanceof Q.Just)return fv.liftEffect(uv.monadEffectAff)(Wo.write(new Q.Just(new br.Cons(e,t.value0)))(n));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 182, column 33 - line 184, column 57): "+[t.constructor.name])}))}},od=function(n){return function(e){return Mn.discard(Mn.discardUnit)(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.write({initializers:br.Nil.value,finalizers:br.Nil.value})(n)))((function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(e))((function(e){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(n)))((function(n){return Mn.discard(Mn.discardUnit)(uv.bindAff)(at.traverse_(uv.applicativeAff)(br.foldableList)(Ts.fork(Ts.monadForkAff))(n.finalizers))((function(t){return Mn.discard(Mn.discardUnit)(uv.bindAff)(Ps.parSequence_(uv.parallelAff)(br.foldableList)(n.initializers))((function(n){return tn.pure(uv.applicativeAff)(e)}))}))}))}))}))}},cd=uv.runAff_(ft.either(Xu.throwException)(H.const(tn.pure(Ro.applicativeEffect)(W.unit)))),fd=function(n){return function(e){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(e)))((function(e){return fv.liftEffect(uv.monadEffectAff)(Wo["modify'"]((function(e){return{state:e+1|0,value:n(e)}}))(e.fresh))}))}},ld=function(n){return function(e){return function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(e)))((function(r){return vd(n)(e)(r.component.eval(new Lc.Query(x.map(ko.functorCoyoneda)(Q.Just.create)(ko.liftCoyoneda(t)),H.const(Q.Nothing.value))))}))}}},vd=function(n){return function(e){return function(t){var r;return qo.foldFree(uv.monadRecAff)((r=e,function(e){if(e instanceof Lo.State)return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(t){var u=e.value0(t.state);if(id.unsafeRefEq(t.state)(u.value1))return tn.pure(uv.applicativeAff)(u.value0);if(i.otherwise)return Mn.discard(Mn.discardUnit)(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.write({component:t.component,state:u.value1,refs:t.refs,children:t.children,childrenIn:t.childrenIn,childrenOut:t.childrenOut,selfRef:t.selfRef,handlerRef:t.handlerRef,pendingQueries:t.pendingQueries,pendingOuts:t.pendingOuts,pendingHandlers:t.pendingHandlers,rendering:t.rendering,fresh:t.fresh,subscriptions:t.subscriptions,forks:t.forks,lifecycleHandlers:t.lifecycleHandlers})(r)))((function(e){return Mn.discard(Mn.discardUnit)(uv.bindAff)(od(t.lifecycleHandlers)(n(t.lifecycleHandlers)(r)))((function(n){return tn.pure(uv.applicativeAff)(u.value0)}))}));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 86, column 7 - line 92, column 21): "+[u.constructor.name])}));if(e instanceof Lo.Subscribe)return Mn.bind(uv.bindAff)(fd(Lo.SubscriptionId)(r))((function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(rd.subscribe(e.value0(t))((function(e){return cd(sd(n)(r)(new gl.Action(e)))}))))((function(n){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(r){return Mn.discard(Mn.discardUnit)(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.modify_(x.map(Q.functorMaybe)(Br.insert(Lo.ordSubscriptionId)(t)(n)))(r.subscriptions)))((function(n){return tn.pure(uv.applicativeAff)(e.value1(t))}))}))}))}));if(e instanceof Lo.Unsubscribe)return Mn.discard(Mn.discardUnit)(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)((t=e.value0,function(n){return function(){var e=Wo.read(n)(),r=Wo.read(e.subscriptions)();return at.traverse_(Ro.applicativeEffect)(at.foldableMaybe)(rd.unsubscribe)(Mn.bindFlipped(Q.bindMaybe)(Br.lookup(Lo.ordSubscriptionId)(t))(r))()}})(r)))((function(n){return tn.pure(uv.applicativeAff)(e.value1)}));var t,u,a;if(e instanceof Lo.Lift)return e.value0;if(e instanceof Lo.ChildQuery)return function(e){return function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(e)))((function(e){return ed.unChildQueryBox((function(t){return x.map(uv.functorAff)(t.value2)(cv.sequential(uv.parallelAff)(t.value0(uv.applicativeParAff)((function(e){return cv.parallel(uv.parallelAff)(Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(e)))((function(e){return Xs.unDriverStateX((function(e){return ld(n)(e.selfRef)(t.value1)}))(e)})))}))(e.children)))}))(t)}))}}(r)(e.value0);if(e instanceof Lo.Raise)return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(n){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(n.handlerRef)))((function(t){return Mn.discard(Mn.discardUnit)(uv.bindAff)(ad(n.pendingOuts)(t(e.value0)))((function(n){return tn.pure(uv.applicativeAff)(e.value1)}))}))}));if(e instanceof Lo.Par)return cv.sequential(uv.parallelAff)(Ls.retractFreeAp(uv.applicativeParAff)(Ls.hoistFreeAp((u=cv.parallel(uv.parallelAff),a=vd(n)(r),function(n){return u(a(n))}))(e.value0)));if(e instanceof Lo.Fork)return Mn.bind(uv.bindAff)(fd(Lo.ForkId)(r))((function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(u){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.new(!1)))((function(i){return Mn.bind(uv.bindAff)(Ts.fork(Ts.monadForkAff)(uv.finally(fv.liftEffect(uv.monadEffectAff)(Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.modify_(Br.delete(Lo.ordForkId)(t))(u.forks))((function(n){return Wo.write(!0)(i)}))))(vd(n)(r)(e.value0))))((function(n){return Mn.discard(Mn.discardUnit)(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Le.unlessM(Ro.monadEffect)(Wo.read(i))(Wo.modify_(Br.insert(Lo.ordForkId)(t)(n))(u.forks))))((function(n){return tn.pure(uv.applicativeAff)(e.value1(t))}))}))}))}))}));if(e instanceof Lo.Kill)return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(n){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(n.forks)))((function(n){return Mn.discard(Mn.discardUnit)(uv.bindAff)(at.traverse_(uv.applicativeAff)(at.foldableMaybe)(uv.killFiber(Xu.error("Cancelled")))(Br.lookup(Lo.ordForkId)(e.value0)(n)))((function(n){return tn.pure(uv.applicativeAff)(e.value1)}))}))}));if(e instanceof Lo.GetRef)return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(r)))((function(n){return tn.pure(uv.applicativeAff)(e.value1(Br.lookup(l.ordString)(e.value0)(n.refs)))}));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 83, column 12 - line 133, column 33): "+[e.constructor.name])}))(t)}}},sd=function(n){return function(e){return function(t){if(t instanceof gl.RefUpdate)return fv.liftEffect(uv.monadEffectAff)(H.flip(Wo.modify_)(e)(Xs.mapDriverState((function(n){return{component:n.component,state:n.state,refs:Br.alter(l.ordString)(H.const(t.value1))(t.value0)(n.refs),children:n.children,childrenIn:n.childrenIn,childrenOut:n.childrenOut,selfRef:n.selfRef,handlerRef:n.handlerRef,pendingQueries:n.pendingQueries,pendingOuts:n.pendingOuts,pendingHandlers:n.pendingHandlers,rendering:n.rendering,fresh:n.fresh,subscriptions:n.subscriptions,forks:n.forks,lifecycleHandlers:n.lifecycleHandlers}}))));if(t instanceof gl.Action)return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(e)))((function(r){return vd(n)(e)(r.component.eval(new Lc.Action(t.value0,W.unit)))}));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 52, column 20 - line 58, column 62): "+[t.constructor.name])}}};Rs={evalF:sd,evalQ:ld,evalM:vd,handleLifecycle:od,queueOrRun:ad,handleAff:cd};var dd=Wo.new({initializers:br.Nil.value,finalizers:br.Nil.value}),pd=function(n){return function(){var e=Wo.read(n)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(Q.Nothing.value)(n))((function(n){return at.for_(Ro.applicativeEffect)(at.foldableMaybe)(e)((t=at.traverse_(uv.applicativeAff)(br.foldableList)(Ts.fork(Ts.monadForkAff)),function(n){return Rs.handleAff(t(hr.reverse(n)))}));var t}))()}};ks={runUI:function(n){return function(e){return function(t){var r=function(n){return function(e){return function(t){return Mo.unComponent((function(r){return function(){var i=dd(),a=Xs.initDriverState(r)(t)(e)(i)(),o=Wo.read(n)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write({initializers:br.Nil.value,finalizers:o.finalizers})(n))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Mn.bindFlipped(Ro.bindEffect)(Xs.unDriverStateX((t=u(n),function(n){return t(n.selfRef)})))(Wo.read(a)))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Mn.bindFlipped(Ro.bindEffect)(function(n){return function(e){return Xs.unDriverStateX((function(t){var r=Rs.evalM(u)(t.selfRef)(t.component.eval(new Lc.Initialize(W.unit)));return Wo.modify_((function(n){return{initializers:new br.Cons(Mn.discard(Mn.discardUnit)(uv.bindAff)(Ps.parSequence_(uv.parallelAff)(br.foldableList)(hr.reverse(n.initializers)))((function(n){return Mn.discard(Mn.discardUnit)(uv.bindAff)(r)((function(n){return fv.liftEffect(uv.monadEffectAff)(Mn.discard(Mn.discardUnit)(Ro.bindEffect)(pd(t.pendingQueries))((function(n){return pd(t.pendingOuts)})))}))})),e),finalizers:n.finalizers}}))(n)}))}}(n)(o.initializers))(Wo.read(a)))((function(n){return tn.pure(Ro.applicativeEffect)(a)}))}));var t}))()}}))}}},u=function(e){return function(t){return function(){var a=Wo.read(t)(),o=x.map(Ro.functorEffect)(Q.isNothing)(Wo.read(a.pendingHandlers))();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(tn.when(Ro.applicativeEffect)(o)(Wo.write(new Q.Just(br.Nil.value))(a.pendingHandlers)))((function(t){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(js.empty)(a.childrenOut))((function(t){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(a.children)(a.childrenIn))((function(t){var c,f,l,v,s=an.identity(an.categoryFn)(a.selfRef),d=an.identity(an.categoryFn)(a.pendingQueries),p=an.identity(an.categoryFn)(a.pendingHandlers),m=(c=Rs.queueOrRun(p),f=x.void(uv.functorAff),l=Rs.evalF(u)(s),function(n){return c(f(l(n)))}),w=(v=Rs.queueOrRun(d),function(n){return v(m(gl.Action.create(n)))});return function(){var t=n.render((function(n){return Rs.handleAff(m(n))}))(function(e){return function(t){return function(i){return function(a){return Mo.unComponentSlot((function(o){return function(){var c=x.map(Ro.functorEffect)(o.pop)(Wo.read(i))(),f=function(){if(c instanceof Q.Just)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(c.value0.value1)(i))((function(n){return function(){var n=Wo.read(c.value0.value0)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Xs.unDriverStateX((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(H.flip(Wo.write)(n.handlerRef)((e=Q.maybe(tn.pure(uv.applicativeAff)(W.unit))(t),function(n){return e(o.output(n))})))((function(e){return Rs.handleAff(Rs.evalM(u)(n.selfRef)(n.component.eval(new Lc.Receive(o.input,W.unit))))}));var e}))(n))((function(n){return tn.pure(Ro.applicativeEffect)(c.value0.value0)}))()}}))();if(c instanceof Q.Nothing)return r(e)((n=Q.maybe(tn.pure(uv.applicativeAff)(W.unit))(t),function(e){return n(o.output(e))}))(o.input)(o.component)();var n;throw new Error("Failed pattern match at Halogen.Aff.Driver (line 210, column 14 - line 219, column 98): "+[c.constructor.name])}(),l=x.map(Ro.functorEffect)((function(n){return Q.isJust(o.get(n))}))(Wo.read(a))();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(tn.when(Ro.applicativeEffect)(l)(Ns.warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur")))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.modify_(o.set(f))(a))((function(e){return Mn.bind(Ro.bindEffect)(Wo.read(f))(Xs.renderStateX(Ro.functorEffect)((function(e){if(e instanceof Q.Nothing)return Xu.throw("Halogen internal error: child was not initialized in renderChild");if(e instanceof Q.Just)return tn.pure(Ro.applicativeEffect)(n.renderChild(e.value0));throw new Error("Failed pattern match at Halogen.Aff.Driver (line 224, column 37 - line 226, column 50): "+[e.constructor.name])})))}))}))()}}))}}}}(e)(w)(a.childrenIn)(a.childrenOut))(a.component.render(a.state))(a.rendering)(),c=Wo.read(a.childrenOut)(),f=Wo.read(a.childrenIn)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(js.foreachSlot(Ro.applicativeEffect)(f)((function(t){return function(){var r=Wo.read(t)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Xs.renderStateX_(Ro.applicativeEffect)(n.removeChild)(r))((function(n){return i(e)(r)}))()}})))((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(H.flip(Wo.modify_)(a.selfRef)(Xs.mapDriverState((function(n){return{component:n.component,state:n.state,refs:n.refs,children:c,childrenIn:n.childrenIn,childrenOut:n.childrenOut,selfRef:n.selfRef,handlerRef:n.handlerRef,pendingQueries:n.pendingQueries,pendingOuts:n.pendingOuts,pendingHandlers:n.pendingHandlers,rendering:new Q.Just(t),fresh:n.fresh,subscriptions:n.subscriptions,forks:n.forks,lifecycleHandlers:n.lifecycleHandlers}}))))((function(n){return tn.when(Ro.applicativeEffect)(o)(H.flip(Do.tailRecM(Do.monadRecEffect))(W.unit)((function(n){return function(){var n=Wo.read(p)();return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(new Q.Just(br.Nil.value))(p))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(at.traverse_(Ro.applicativeEffect)(at.foldableMaybe)((t=at.traverse_(uv.applicativeAff)(br.foldableList)(Ts.fork(Ts.monadForkAff)),function(n){return Rs.handleAff(t(hr.reverse(n)))}))(n))((function(n){return function(){var n=Wo.read(p)();return Q.maybe(!1)(hr.null)(n)?x.voidLeft(Ro.functorEffect)(Wo.write(Q.Nothing.value)(p))(new Do.Done(W.unit))():new Do.Loop(W.unit)}}));var t}))()}})))}))}))()}}))}))}))()}}},i=function(n){return Xs.unDriverStateX((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((t=e,Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Mn.bindFlipped(Ro.bindEffect)(at.traverse_(Ro.applicativeEffect)(at.foldableMaybe)(at.traverse_(Ro.applicativeEffect)(Br.foldableMap)(rd.unsubscribe)))(Wo.read(t.subscriptions)))((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(Q.Nothing.value)(t.subscriptions))((function(n){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Mn.bindFlipped(Ro.bindEffect)(at.traverse_(Ro.applicativeEffect)(Br.foldableMap)((e=uv.killFiber(Xu.error("finalized")),function(n){return Rs.handleAff(e(n))})))(Wo.read(t.forks)))((function(n){return Wo.write(Br.empty)(t.forks)}));var e}))}))))((function(t){var r=Rs.evalM(u)(e.selfRef)(e.component.eval(new Lc.Finalize(W.unit)));return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.modify_((function(n){return{initializers:n.initializers,finalizers:new br.Cons(r,n.finalizers)}}))(n))((function(t){return js.foreachSlot(Ro.applicativeEffect)(e.children)((function(e){return function(){var t=Wo.read(e)();return i(n)(t)()}}))}))}));var t}))},a=function(n){return function(e){return function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.read(n)))((function(n){return n?tn.pure(uv.applicativeAff)(Q.Nothing.value):Rs.evalQ(u)(e)(t)}))}}},o=function(e){return function(t){return function(r){return Rs.handleLifecycle(t)((function(){return Wo.read(e)()?W.unit:Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(!0)(e))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(i(t)(r))((function(e){return Xs.unDriverStateX((function(e){return function(){var t=fv.liftEffect(fv.monadEffectEffect)(Wo.read(e.selfRef))();return at.for_(Ro.applicativeEffect)(at.foldableMaybe)(t.rendering)(n.dispose)()}}))(r)}))}))()}))}}};return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(dd))((function(n){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(Wo.new(!1)))((function(u){return Rs.handleLifecycle(n)((function(){var i,c,f=rd.create(),l=Mn.bindFlipped(Ro.bindEffect)(Wo.read)(r(n)((i=fv.liftEffect(uv.monadEffectAff),c=rd.notify(f.listener),function(n){return i(c(n))}))(t)(e))();return Xs.unDriverStateX((function(e){return tn.pure(Ro.applicativeEffect)({query:a(u)(e.selfRef),messages:f.emitter,dispose:o(u)(n)(l)})}))(l)()}))}))}))}}}};var md,wd={};wd={toNode:ze.unsafeCoerce};var hd=function(n){return yf.halt(n.widget)},bd=function(n,e){if(e instanceof Df.Grafted)return bd(n,Df.runGraft(e.value0));if(e instanceof Df.Widget){var t=yf.step(n.widget,e.value0);return yf.unStep((function(e){return yf.mkStep(new yf.Step(e.value0,{build:n.build,widget:t},bd,hd))}))(t)}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return hd(n)}))((function(t){return function(){return n.build(e)}}))()},yd=function(n){var e=Tf.parentNode(n.node);return Tf.removeChild(n.node,e)},gd=function(n,e){if(e instanceof Df.Grafted)return gd(n,Df.runGraft(e.value0));if(e instanceof Df.Text){if(n.value===e.value0)return yf.mkStep(new yf.Step(n.node,n,gd,yd));if(i.otherwise){var t={build:n.build,node:n.node,value:e.value0};return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.setTextContent(e.value0,n.node)}))((function(e){return tn.pure(Ro.applicativeEffect)(yf.mkStep(new yf.Step(n.node,t,gd,yd)))}))()}}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return yd(n)}))((function(t){return function(){return n.build(e)}}))()},Ed=function(n){var e=Tf.parentNode(n.node);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.removeChild(n.node,e)}))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.forInE(n.children,(function(n,e){return yf.halt(e)}))}))((function(e){return function(){return yf.halt(n.attrs)}}))}))()},Ad=function(n){var e=Tf.parentNode(n.node);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.removeChild(n.node,e)}))((function(e){return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.forEachE(n.children,yf.halt)}))((function(e){return function(){return yf.halt(n.attrs)}}))}))()},Sd=function(n,e,t,r){return!(e!==r)&&(n instanceof Q.Just&&t instanceof Q.Just&&n.value0===t.value0||n instanceof Q.Nothing&&t instanceof Q.Nothing)},Md=function(n,e){if(e instanceof Df.Grafted)return Md(n,Df.runGraft(e.value0));if(e instanceof Df.Elem&&Sd(n.ns,n.name,e.value0,e.value1)){var t=it.length(e.value3);if(0===it.length(n.children)&&0===t){var r=yf.step(n.attrs,e.value2),u={build:n.build,node:n.node,attrs:r,ns:e.value0,name:e.value1,children:n.children};return yf.mkStep(new yf.Step(n.node,u,Md,Ad))}var i=Tf.diffWithIxE(n.children,e.value3,(function(e,t,r){var u=yf.step(t,r);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(e,yf.extract(u),n.node)}))((function(n){return tn.pure(Ro.applicativeEffect)(u)}))()}),(function(n,e){return yf.halt(e)}),(function(e,t){var r=n.build(t);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(e,yf.extract(r),n.node)}))((function(n){return tn.pure(Ro.applicativeEffect)(r)}))()}));r=yf.step(n.attrs,e.value2),u={build:n.build,node:n.node,attrs:r,ns:e.value0,name:e.value1,children:i};return yf.mkStep(new yf.Step(n.node,u,Md,Ad))}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Ad(n)}))((function(t){return function(){return n.build(e)}}))()},kd=function(n,e){if(e instanceof Df.Grafted)return kd(n,Df.runGraft(e.value0));if(e instanceof Df.Keyed&&Sd(n.ns,n.name,e.value0,e.value1)){var t=it.length(e.value3);if(0===n.length&&0===t){var r=yf.step(n.attrs,e.value2),u={build:n.build,node:n.node,attrs:r,ns:e.value0,name:e.value1,children:n.children,length:0};return yf.mkStep(new yf.Step(n.node,u,kd,Ed))}var i=Tf.diffWithKeyAndIxE(n.children,e.value3,oe.fst,(function(e,t,r,u){var i=yf.step(r,u.value1);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(t,yf.extract(i),n.node)}))((function(n){return tn.pure(Ro.applicativeEffect)(i)}))()}),(function(n,e){return yf.halt(e)}),(function(e,t,r){var u=n.build(r.value1);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(t,yf.extract(u),n.node)}))((function(n){return tn.pure(Ro.applicativeEffect)(u)}))()}));r=yf.step(n.attrs,e.value2),u={build:n.build,node:n.node,attrs:r,ns:e.value0,name:e.value1,children:i,length:t};return yf.mkStep(new yf.Step(n.node,u,kd,Ed))}return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Ed(n)}))((function(t){return function(){return n.build(e)}}))()},Td=function(n,e,t){var r=n.buildWidget(n)(t);return yf.unStep((function(n){return yf.mkStep(new yf.Step(n.value0,{build:e,widget:r},bd,hd))}))(r)},Fd=function(n,e,t){var r=Tf.createTextNode(t,n.document),u={build:e,node:r,value:t};return yf.mkStep(new yf.Step(r,u,gd,yd))},Id=function(n,e,t,r,u,i){var a=Tf.createElement(wf.toNullable(t),r,n.document),o=wd.toNode(a),c=Tf.strMapWithIxE(i,oe.fst,(function(n,t,r){var u=e(r.value1);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(t,yf.extract(u),o)}))((function(n){return tn.pure(Ro.applicativeEffect)(u)}))()})),f=n.buildAttributes(a)(u),l={build:e,node:o,attrs:f,ns:t,name:r,children:c,length:it.length(i)};return yf.mkStep(new yf.Step(o,l,kd,Ed))},Pd=function(n,e,t,r,u,i){var a=Tf.createElement(wf.toNullable(t),r,n.document),o=wd.toNode(a),c=Tf.forE(i,(function(n,t){var r=e(t);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return Tf.insertChildIx(n,yf.extract(r),o)}))((function(n){return tn.pure(Ro.applicativeEffect)(r)}))()})),f=n.buildAttributes(a)(u),l={build:e,node:o,attrs:f,ns:t,name:r,children:c};return yf.mkStep(new yf.Step(o,l,Md,Ad))};md={VDomSpec:function(n){return n},buildVDom:function(n){var e=function(t){if(t instanceof Df.Text)return Fd(n,e,t.value0);if(t instanceof Df.Elem)return Pd(n,e,t.value0,t.value1,t.value2,t.value3);if(t instanceof Df.Keyed)return Id(n,e,t.value0,t.value1,t.value2,t.value3);if(t instanceof Df.Widget)return Td(n,e,t.value0);if(t instanceof Df.Grafted)return e(Df.runGraft(t.value0));throw new Error("Failed pattern match at Halogen.VDom.DOM (line 58, column 27 - line 63, column 52): "+[t.constructor.name])};return e},buildText:Fd,buildElem:Pd,buildKeyed:Id,buildWidget:Td};!function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}}}();var Cd,Nd=function(n){return n.value2(n.value3)};Cd={buildThunk:function(n){var e=function(n){return yf.halt(n.vdom)},t=function(r,u){var i,a;if(i=r.thunk,a=u,Tf.refEq(i.value0,a.value0)&&Tf.refEq(i.value1,a.value1)&&i.value1(i.value3,a.value3))return yf.mkStep(new yf.Step(yf.extract(r.vdom),r,t,e));var o=yf.step(r.vdom,n(Nd(u)));return yf.mkStep(new yf.Step(yf.extract(o),{vdom:o,thunk:u},t,e))};return function(r){return function(u){var i=md.buildVDom(r)(n(Nd(u)));return yf.mkStep(new yf.Step(yf.extract(i),{thunk:u,vdom:i},t,e))}}},runThunk:Nd};var Ld,qd,Rd,Bd,_d,Jd={},Dd=function(n){return function(e){return function(){return e[n]}}};Ld=Dd("parentNode"),qd=Dd("nextSibling"),Rd=function(n){return function(e){return function(t){return function(){t.insertBefore(n,e)}}}},Bd=function(n){return function(e){return function(){e.appendChild(n)}}},_d=function(n){return function(e){return function(){e.removeChild(n)}}};var Od,Ud,xd=(Od=x.map(Ro.functorEffect)(wf.toMaybe),function(n){return Od(Ld(n))}),Hd=(Ud=x.map(Ro.functorEffect)(wf.toMaybe),function(n){return Ud(qd(n))});Jd={parentNode:xd,nextSibling:Hd,insertBefore:Rd,appendChild:Bd,removeChild:_d};var Qd=function(n){return function(){var e=Jd.parentNode(n.node)();return at.traverse_(Ro.applicativeEffect)(at.foldableMaybe)((function(e){return Jd.removeChild(n.node)(e)}))(e)()}},Wd=function(n){return function(e){return{render:function(t){return function(r){return function(u){return function(i){if(i instanceof Q.Nothing)return function(){var i=Wo.new(r)(),a=function(n){return function(e){return function(t){var r=Xs.unRenderStateX((function(n){return n.node})),u=function(n){return n instanceof Q.Just?yf.halt(n.value0):W.unit};return{buildWidget:function(n){var t=Cd.buildThunk(We.unwrap())(n),i=function(n){var t=Wo.read(e)()(n)(),i=r(t);return yf.mkStep(new yf.Step(i,Q.Nothing.value,o,u))},a=function(n){if(n instanceof Mo.ComponentSlot)return i(n.value0);if(n instanceof Mo.ThunkSlot){var e=t(n.value0);return yf.mkStep(new yf.Step(yf.extract(e),new Q.Just(e),o,u))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 85, column 7 - line 90, column 75): "+[n.constructor.name])},o=function(n,e){if(n instanceof Q.Just){if(e instanceof Mo.ComponentSlot)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)((function(){return yf.halt(n.value0)}))((function(n){return function(){return i(e.value0)}}))();if(e instanceof Mo.ThunkSlot){var t=yf.step(n.value0,e.value0);return yf.mkStep(new yf.Step(yf.extract(t),new Q.Just(t),o,u))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 98, column 22 - line 104, column 79): "+[e.constructor.name])}return a(e)};return a},buildAttributes:mf.buildProp(n),document:t}}}}(t)(i)(n),o=md.buildVDom(a)(u),c=yf.extract(o);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(x.void(Ro.functorEffect)(Jd.appendChild(c)(ls.toNode(e))))((function(n){return tn.pure(Ro.applicativeEffect)({machine:o,node:c,renderChildRef:i})}))()};if(i instanceof Q.Just)return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(Wo.write(r)(i.value0.renderChildRef))((function(n){return function(){var n=Jd.parentNode(i.value0.node)(),e=Jd.nextSibling(i.value0.node)(),t=yf.step(i.value0.machine,u),r=yf.extract(t);return Mn.discard(Mn.discardUnit)(Ro.bindEffect)(tn.when(Ro.applicativeEffect)(ws.not(ws.heytingAlgebraFunction(ws.heytingAlgebraFunction(ws.heytingAlgebraBoolean)))(id.unsafeRefEq)(i.value0.node)(r))(function(n){return function(e){return function(t){return e instanceof Q.Just&&t instanceof Q.Just?x.void(Ro.functorEffect)(Jd.insertBefore(n)(e.value0)(t.value0)):e instanceof Q.Nothing&&t instanceof Q.Just?x.void(Ro.functorEffect)(Jd.appendChild(n)(t.value0)):tn.pure(Ro.applicativeEffect)(W.unit)}}}(r)(e)(n)))((function(n){return tn.pure(Ro.applicativeEffect)({machine:t,node:r,renderChildRef:i.value0.renderChildRef})}))()}}));throw new Error("Failed pattern match at Halogen.VDom.Driver (line 159, column 5 - line 175, column 80): "+[i.constructor.name])}}}},renderChild:an.identity(an.categoryFn),removeChild:Qd,dispose:Qd}}};ms={runUI:function(n){return function(e){return function(t){return Mn.bind(uv.bindAff)(fv.liftEffect(uv.monadEffectAff)(x.map(Ro.functorEffect)($v.toDocument)(Mn.bindFlipped(Ro.bindEffect)(vs.document)(Xv.window))))((function(r){return ks.runUI(Wd(r)(t))(n)(e)}))}}}},{main:jv.runHalogenAff(Mn.bind(uv.bindAff)(jv.awaitBody)((function(e){return ms.runUI(n.component(Wv.monadAffAff))(W.unit)(e)})))}.main();